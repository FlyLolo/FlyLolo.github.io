<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>FlyLolo 闲聊编程</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="没事敲敲代码">
    
    <link rel="preload" href="/assets/css/0.styles.b23bcaa9.css" as="style"><link rel="preload" href="/assets/js/app.5c4124d9.js" as="script"><link rel="preload" href="/assets/js/2.5052fd89.js" as="script"><link rel="preload" href="/assets/js/83.6c0ee3d0.js" as="script"><link rel="prefetch" href="/assets/js/10.ebd354ff.js"><link rel="prefetch" href="/assets/js/11.c0ba7b39.js"><link rel="prefetch" href="/assets/js/12.d2df4345.js"><link rel="prefetch" href="/assets/js/13.ad189de6.js"><link rel="prefetch" href="/assets/js/14.211e1c27.js"><link rel="prefetch" href="/assets/js/15.bc9f8b57.js"><link rel="prefetch" href="/assets/js/16.5cc9b653.js"><link rel="prefetch" href="/assets/js/17.4281fea3.js"><link rel="prefetch" href="/assets/js/18.1c3b6824.js"><link rel="prefetch" href="/assets/js/19.19526aaa.js"><link rel="prefetch" href="/assets/js/20.55520ac3.js"><link rel="prefetch" href="/assets/js/21.68aa2210.js"><link rel="prefetch" href="/assets/js/22.976b6f6a.js"><link rel="prefetch" href="/assets/js/23.9241ad9a.js"><link rel="prefetch" href="/assets/js/24.87e81add.js"><link rel="prefetch" href="/assets/js/25.5a324370.js"><link rel="prefetch" href="/assets/js/26.6e0c7b3a.js"><link rel="prefetch" href="/assets/js/27.c2db3589.js"><link rel="prefetch" href="/assets/js/28.f504554f.js"><link rel="prefetch" href="/assets/js/29.0b8cbb3f.js"><link rel="prefetch" href="/assets/js/3.dc0bd479.js"><link rel="prefetch" href="/assets/js/30.18cf6f70.js"><link rel="prefetch" href="/assets/js/31.90a5f0a4.js"><link rel="prefetch" href="/assets/js/32.454348da.js"><link rel="prefetch" href="/assets/js/33.1c21d0c1.js"><link rel="prefetch" href="/assets/js/34.a2fc1109.js"><link rel="prefetch" href="/assets/js/35.7123c8b5.js"><link rel="prefetch" href="/assets/js/36.6a74523e.js"><link rel="prefetch" href="/assets/js/37.4a0d5e49.js"><link rel="prefetch" href="/assets/js/38.870830b5.js"><link rel="prefetch" href="/assets/js/39.7a99876d.js"><link rel="prefetch" href="/assets/js/4.2543b7ad.js"><link rel="prefetch" href="/assets/js/40.1ab956e2.js"><link rel="prefetch" href="/assets/js/41.e2cd491a.js"><link rel="prefetch" href="/assets/js/42.8118b296.js"><link rel="prefetch" href="/assets/js/43.3b58128f.js"><link rel="prefetch" href="/assets/js/44.1648ce27.js"><link rel="prefetch" href="/assets/js/45.0e2feba0.js"><link rel="prefetch" href="/assets/js/46.8cacc6f0.js"><link rel="prefetch" href="/assets/js/47.85a42084.js"><link rel="prefetch" href="/assets/js/48.887f0baf.js"><link rel="prefetch" href="/assets/js/49.311ea494.js"><link rel="prefetch" href="/assets/js/5.82bf0454.js"><link rel="prefetch" href="/assets/js/50.1a3416b2.js"><link rel="prefetch" href="/assets/js/51.17ac5138.js"><link rel="prefetch" href="/assets/js/52.0e0119e0.js"><link rel="prefetch" href="/assets/js/53.a74775a2.js"><link rel="prefetch" href="/assets/js/54.4dc1f4cf.js"><link rel="prefetch" href="/assets/js/55.782ceae6.js"><link rel="prefetch" href="/assets/js/56.d371faac.js"><link rel="prefetch" href="/assets/js/57.42acf1f9.js"><link rel="prefetch" href="/assets/js/58.508c5ac0.js"><link rel="prefetch" href="/assets/js/59.a747c5df.js"><link rel="prefetch" href="/assets/js/6.d83b86ff.js"><link rel="prefetch" href="/assets/js/60.1a0f169d.js"><link rel="prefetch" href="/assets/js/61.eb35190d.js"><link rel="prefetch" href="/assets/js/62.508f7c4c.js"><link rel="prefetch" href="/assets/js/63.4c9bbdbe.js"><link rel="prefetch" href="/assets/js/64.5f784752.js"><link rel="prefetch" href="/assets/js/65.83e85dd4.js"><link rel="prefetch" href="/assets/js/66.c3c68bbd.js"><link rel="prefetch" href="/assets/js/67.15ce6b9a.js"><link rel="prefetch" href="/assets/js/68.2f1ad103.js"><link rel="prefetch" href="/assets/js/69.e220c066.js"><link rel="prefetch" href="/assets/js/7.fbd6423b.js"><link rel="prefetch" href="/assets/js/70.024cc331.js"><link rel="prefetch" href="/assets/js/71.424df8a7.js"><link rel="prefetch" href="/assets/js/72.87abc657.js"><link rel="prefetch" href="/assets/js/73.ea6962e5.js"><link rel="prefetch" href="/assets/js/74.c50c111e.js"><link rel="prefetch" href="/assets/js/75.4d2a7dbe.js"><link rel="prefetch" href="/assets/js/76.49e30c54.js"><link rel="prefetch" href="/assets/js/77.5d8c8f6d.js"><link rel="prefetch" href="/assets/js/78.5b4f8e29.js"><link rel="prefetch" href="/assets/js/79.316dc7d8.js"><link rel="prefetch" href="/assets/js/8.a45bb22d.js"><link rel="prefetch" href="/assets/js/80.b1c365a1.js"><link rel="prefetch" href="/assets/js/81.cb25e543.js"><link rel="prefetch" href="/assets/js/82.7bc18643.js"><link rel="prefetch" href="/assets/js/84.f8184dc3.js"><link rel="prefetch" href="/assets/js/85.b0a7f43e.js"><link rel="prefetch" href="/assets/js/86.af5fcb58.js"><link rel="prefetch" href="/assets/js/9.55a96ecc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b23bcaa9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="FlyLolo 闲聊编程" class="logo"> <span class="site-name can-hide">FlyLolo 闲聊编程</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/dotnet/" class="nav-link router-link-active">
  .NET
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/db/" class="nav-link">
  DB
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/language/japanese/" class="nav-link">
  Japanese
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/dotnet/" class="nav-link router-link-active">
  .NET
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/db/" class="nav-link">
  DB
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/language/japanese/" class="nav-link">
  Japanese
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>ASP.NET Core</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dotnet/" aria-current="page" class="sidebar-link">新书上市</a></li><li><a href="/dotnet/ASPNETCore2_1.html" class="sidebar-link">一. 概述</a></li><li><a href="/dotnet/ASPNETCore2_2.html" class="sidebar-link">二. 开发环境</a></li><li><a href="/dotnet/ASPNETCore2_3.html" class="sidebar-link">三. 项目结构</a></li><li><a href="/dotnet/ASPNETCore2_4.html" class="sidebar-link">四. Layout与ViewStart</a></li><li><a href="/dotnet/ASPNETCore2_5.html" class="sidebar-link">五.服务的加载与运行</a></li><li><a href="/dotnet/ASPNETCore2_6.html" class="sidebar-link">六. 聊聊依赖注入</a></li><li><a href="/dotnet/ASPNETCore2_7.html" class="sidebar-link">七.启动背后的秘密</a></li><li><a href="/dotnet/ASPNETCore2_8.html" class="sidebar-link">八.图说管道</a></li><li><a href="/dotnet/ASPNETCore2_9.html" class="sidebar-link">九.发布到CentOS</a></li><li><a href="/dotnet/ASPNETCore2_10.html" class="sidebar-link">十.升级到2.1</a></li><li><a href="/dotnet/ASPNETCore2_11.html" class="sidebar-link">十一.运行后台任务</a></li><li><a href="/dotnet/ASPNETCore2_12.html" class="sidebar-link">十二.内置日志与Nlog</a></li><li><a href="/dotnet/ASPNETCore2_13.html" class="sidebar-link">十三.httpClient.GetAsync 报SSL错误</a></li><li><a href="/dotnet/ASPNETCore2_14.html" class="sidebar-link">十四.静态文件访问与授权</a></li><li><a href="/dotnet/ASPNETCore2_15.html" class="sidebar-link">十五.图解路由(2.1 or earler)</a></li><li><a href="/dotnet/ASPNETCore2_16.html" class="sidebar-link">十六.新的Endpoint路由方案</a></li><li><a href="/dotnet/ASPNETCore2_17.html" class="sidebar-link">十七.Action的执行</a></li><li><a href="/dotnet/ASPNETCore2_18.html" class="sidebar-link">十八.Filter的处理机制及执行顺序</a></li><li><a href="/dotnet/ASPNETCore2_19.html" class="sidebar-link">十九. Action参数的映射与模型绑定</a></li><li><a href="/dotnet/ASPNETCore2_20.html" class="sidebar-link">二十.Action的数据返回格式处理</a></li><li><a href="/dotnet/ASPNETCore2_21.html" class="sidebar-link">二十一. 内容协商与自定义返回格式</a></li><li><a href="/dotnet/ASPNETCore_22.html" class="sidebar-link">二十二. 多样性的配置方式</a></li><li><a href="/dotnet/ASPNETCore_23.html" class="sidebar-link">二十三. 配置的内部处理机制</a></li><li><a href="/dotnet/ASPNETCore_24.html" class="sidebar-link">二十四. Options模式的配置</a></li><li><a href="/dotnet/ASPNETCore_25.html" class="sidebar-link">二十五. TagHelper</a></li><li><a href="/dotnet/ASPNETCore2_26.html" class="sidebar-link">二十六. 应用JWT进行用户认证</a></li><li><a href="/dotnet/ASPNETCore2_27.html" class="sidebar-link">二十七. JWT与用户授权</a></li><li><a href="/dotnet/ASPNETCore_28.html" class="sidebar-link">二十八. 在Docker中部署</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>C# 其他</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>将很早之前写的一个小组件重新整理优化一下，做成一个通用的功能。适用于导出数据库的结构（表、字段等）到Word或将体检数据自动生成Word版的体检报告等。代码：<a href="https://github.com/FlyLolo/WordReport" target="_blank" rel="noopener noreferrer">Github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_1-主要需要完成功能"><a href="#_1-主要需要完成功能" class="header-anchor">#</a> 1. 主要需要完成功能:</h2> <ol><li><p>灵活的配置规则及word样式设置（文本、表格、图表、颜色等）.</p></li> <li><p>支持表格.</p></li> <li><p>支持图表.</p></li> <li><p>支持章节内容循环生成.</p></li> <li><p>支持目录.</p></li></ol> <p>6.支持文档结构图</p> <p>7.更新指定位置的文字</p> <p>8.支持pdf导出.</p> <p>最后结果如下:</p> <p><img src="/blogimages/WordReport/548134-20181029144356122-1713299705.png" alt=""></p> <p>图一</p> <p><img src="/blogimages/WordReport/548134-20181029135957011-62906171.png" alt=""></p> <p>图二</p> <p><img src="/blogimages/WordReport/548134-20181029140013936-2098987640.png" alt=""></p> <p>图三</p> <h2 id="_2-需求分析与实现方式"><a href="#_2-需求分析与实现方式" class="header-anchor">#</a> 2. 需求分析与实现方式</h2> <p>功能主要涉及3个比较重要的部分：数据源、Word样式、配置规则。</p> <p>为了简单,数据源决定采用一个存储过程返回Dataset的方式, 整张报告的数据来源于此Dataset的多个Datatable.</p> <p>样式与配置：首先想到的是写一个config文件，所有配置都放到一个文件里，然后将数据按照这个规则生成word。但无疑这样的配置项太多了，关键是“样式”问题，比如字体、颜色、表格宽度.....想想就头大。而且没有“所见即所得”的效果，配置完都不知道啥样。</p> <p>后来决定采取修改的方式, 先以一个word文件作为模板，在模板中定义好上面提到的“样式”，然后在模板中做一个个标记，然后将数据按照规则更新到对应的标记。</p> <p><img src="/blogimages/WordReport/548134-20181029143104735-372624253.png" alt=""></p> <p>图四</p> <p>而这个标记我们用到了word的一个叫【书签】的功能，打开word按ctrl+shift+F5, 打开书签功能，如下图：</p> <p><img src="/blogimages/WordReport/548134-20181029142709314-476661895.png" alt=""></p> <p>图五</p> <p>这样将【规则】通过一系列规则的【书签】定义到word模板中。</p> <h2 id="_3-规则配置"><a href="#_3-规则配置" class="header-anchor">#</a> 3. 规则配置</h2> <p>思路确定了，那就开始设计如何通过【书签】将规则定义到word模板中去，这里决定将所有规则都通过【书签】实现，而放弃config文件的方式，这个更统一而且直观一些。</p> <h2 id="a-循环"><a href="#a-循环" class="header-anchor">#</a> A.循环</h2> <p>以图四为例，数据库有多少张表是不固定的，我们在制作模板的时候不可能先画好N（N为表的总数）个表格等待数据填充， 这里就会需要遍历数据源中提供的所有表结构数据，然后逐一形成表格。这里就需要将图四中的表格循环一下，自动复制生成多个这样的表格。当然，这只是一种情况，还有可能会出现循环嵌套循环的情况，那么我将这个循环定义成一个书签的时候按照这样的格式：</p> <p><strong>loop_级别_表序号_filter_名称</strong></p> <p>含义如下：</p> <p>loop：代表这是一个循环。</p> <p>级别：默认文档级别为0，出现的第一层循环为1，其内部若再次嵌套循环则级别为2，依次类推。</p> <p>表序号：取Dataset中的第几张表(从1开始)</p> <p>filter：循环的时候可能会用到对datatable的查找过滤，在此写出，多个字段用XX隔开(因为此处不允许有下划线外其他特殊字符, 就用这个XX吧 )</p> <p>名称：loop名称，方便与其他 loop区别</p> <h2 id="b-更新指定位置的文字"><a href="#b-更新指定位置的文字" class="header-anchor">#</a> B.更新指定位置的文字</h2> <p>如图四中的【服务器名】、【表总数】等，只需要替换对应的文字即可：</p> <p>label_级别_名称</p> <p>含义如下：</p> <p>label：代表这是一个label。</p> <p>级别：默认文档级别为0，出现的第一层循环为1，其内部若再次嵌套循环则级别为2，依次类推。</p> <p>名称：label名称</p> <p>注意这里省略了表序号，当级别为0的时候 ，自动取最后一个datatable中的数据，因为这个label经常会用到其他表汇总的数据，可能会用到之前几张表的数据，所以放在其他表都处理好后。当级别为1的时候，自然取该级别循环的行数据。</p> <h2 id="c-表格"><a href="#c-表格" class="header-anchor">#</a> C.表格</h2> <p>表格的配置原本也想对表格添加书签,后来发现有个表格属性, 觉得写在这里更好一些。</p> <p><img src="/blogimages/WordReport/548134-20181029173215552-346156833.png" alt=""></p> <p>如上图所示，【标题】格式为：<strong>table_级别_取Dataset中的第几张表(从1开始)_filter字段多个用XX隔开(此处不允许有下划线外其他特殊字符, 就用这个XX吧 )_名称</strong></p> <p>【说明】为可选项，若需要合计行, 则需要标识, summary或缩写s: [合计]行是模板中表格的第几行   summaryfilter或缩写sf:数据集进一步filter到summary行的条件(因为一个表格只取一个Datatable,通过一个标识指定了哪些datarow是用来作为合计的)</p> <h2 id="d-图表"><a href="#d-图表" class="header-anchor">#</a> D.图表</h2> <p>同样为了方便将配置写在了【标题】，图表生成后会将名称修改过来。</p> <p>配置格式为:chart_级别_取Dataset中的第几张表(从1开始)_filter字段多个用XX隔开(此处不允许有下划线外其他特殊字符, 就用这个XX吧 )_chart名称_是否将Datatable的columnName作为第一行_从datatable第几列开始(列起始为1)_截止列，</p> <p>如下图所示配置即可。</p> <p><img src="/blogimages/WordReport/548134-20181115155921136-2139279347.jpg" alt=""></p> <h2 id="e-目录"><a href="#e-目录" class="header-anchor">#</a> E.目录</h2> <p>无需标识, 模板中添加目录, 当内容处理完成之后, 会根据处理后的结果动态更新目录.</p> <h2 id="_4-主要代码"><a href="#_4-主要代码" class="header-anchor">#</a> 4. 主要代码</h2> <div onclick="cnblogs_code_show('9465317b-1eac-42d2-a654-cc47b2fd8c88')" class="cnblogs_code">![](/blogimages/WordReport/ContractedBlock.gif)![](/blogimages/WordReport/ExpandedBlockStart.gif)
<div id="cnblogs_code_open_9465317b-1eac-42d2-a654-cc47b2fd8c88" class="cnblogs_code_hide"><p><span style="color:#008080;">  1</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System;
</span><span style="color:#008080;">  2</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System.Collections.Generic;
</span><span style="color:#008080;">  3</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System.Data;
</span><span style="color:#008080;">  4</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System.Diagnostics;
</span><span style="color:#008080;">  5</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System.IO;
</span><span style="color:#008080;">  6</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System.Linq;
</span><span style="color:#008080;">  7</span> <span style="color:#0000ff;">using</span><span style="color:#000000;"> System.Reflection;
</span><span style="color:#008080;">  8</span> <span style="color:#0000ff;">using</span> Excel =<span style="color:#000000;"> Microsoft.Office.Interop.Excel;
</span><span style="color:#008080;">  9</span> <span style="color:#0000ff;">using</span> Word =<span style="color:#000000;"> Microsoft.Office.Interop.Word;
</span><span style="color:#008080;"> 10</span> <span style="color:#008080;"> 11</span> <span style="color:#0000ff;">namespace</span><span style="color:#000000;"> FlyLolo.WordReport.Demo
</span><span style="color:#008080;"> 12</span> <span style="color:#000000;">{
</span><span style="color:#008080;"> 13</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">class</span><span style="color:#000000;"> WordReportHelper
</span><span style="color:#008080;"> 14</span> <span style="color:#000000;">    {
</span><span style="color:#008080;"> 15</span> <span style="color:#0000ff;">private</span> Word.Application wordApp = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 16</span> <span style="color:#0000ff;">private</span> Word.Document wordDoc = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 17</span> <span style="color:#0000ff;">private</span> DataSet dataSource = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 18</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">object</span> line =<span style="color:#000000;"> Word.WdUnits.wdLine;
</span><span style="color:#008080;"> 19</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">string</span> errorMsg = <span style="color:#800000;">&quot;&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 20</span> <span style="color:#008080;"> 21</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;"> 22</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 根据模板文件,创建数据报告
</span><span style="color:#008080;"> 23</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;"> 24</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="templateFile"></span><span style="color:#008000;">模板文件名(含路径)</span><span style="color:#808080;"></span> <span style="color:#008080;"> 25</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="newFilePath"></span><span style="color:#008000;">新文件路径)</span><span style="color:#808080;"></span> <span style="color:#008080;"> 26</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="dataSource"></span><span style="color:#008000;">数据源,包含多个datatable</span><span style="color:#808080;"></span> <span style="color:#008080;"> 27</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="saveFormat"></span><span style="color:#008000;">新文件格式:</span><span style="color:#808080;"></span> <span style="color:#008080;"> 28</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">bool</span> CreateReport(<span style="color:#0000ff;">string</span> templateFile, DataSet dataSource, <span style="color:#0000ff;">out</span> <span style="color:#0000ff;">string</span> errorMsg, <span style="color:#0000ff;">string</span> newFilePath, <span style="color:#0000ff;">ref</span> <span style="color:#0000ff;">string</span> newFileName, <span style="color:#0000ff;">int</span> saveFormat = <span style="color:#800080;">16</span><span style="color:#000000;">)
</span><span style="color:#008080;"> 29</span> <span style="color:#000000;">        {
</span><span style="color:#008080;"> 30</span> <span style="color:#0000ff;">this</span>.dataSource =<span style="color:#000000;"> dataSource;
</span><span style="color:#008080;"> 31</span>             errorMsg = <span style="color:#0000ff;">this</span><span style="color:#000000;">.errorMsg;
</span><span style="color:#008080;"> 32</span> <span style="color:#0000ff;">bool</span> rtn =<span style="color:#000000;"> OpenTemplate(templateFile)
</span><span style="color:#008080;"> 33</span>                 &amp;&amp; SetContent(<span style="color:#0000ff;">new</span> WordElement(wordDoc.Range(), dataRow: dataSource.Tables[dataSource.Tables.Count - <span style="color:#800080;">1</span>].Rows[<span style="color:#800080;">0</span><span style="color:#000000;">]))
</span><span style="color:#008080;"> 34</span>                 &amp;&amp;<span style="color:#000000;"> UpdateTablesOfContents()
</span><span style="color:#008080;"> 35</span>                 &amp;&amp; SaveFile(newFilePath, <span style="color:#0000ff;">ref</span><span style="color:#000000;"> newFileName, saveFormat);
</span><span style="color:#008080;"> 36</span> <span style="color:#008080;"> 37</span> <span style="color:#000000;">            CloseAndClear();
</span><span style="color:#008080;"> 38</span> <span style="color:#0000ff;">return</span><span style="color:#000000;"> rtn;
</span><span style="color:#008080;"> 39</span> <span style="color:#000000;">        }
</span><span style="color:#008080;"> 40</span> <span style="color:#008080;"> 41</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;"> 42</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 打开模板文件
</span><span style="color:#008080;"> 43</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;"> 44</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="templateFile"></span> <span style="color:#008080;"> 45</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;"> 46</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span> OpenTemplate(<span style="color:#0000ff;">string</span><span style="color:#000000;"> templateFile)
</span><span style="color:#008080;"> 47</span> <span style="color:#000000;">        {
</span><span style="color:#008080;"> 48</span> <span style="color:#0000ff;">if</span> (!<span style="color:#000000;">File.Exists(templateFile))
</span><span style="color:#008080;"> 49</span> <span style="color:#000000;">            {
</span><span style="color:#008080;"> 50</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">false</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 51</span> <span style="color:#000000;">            }
</span><span style="color:#008080;"> 52</span> <span style="color:#008080;"> 53</span>             wordApp = <span style="color:#0000ff;">new</span><span style="color:#000000;"> Word.Application();
</span><span style="color:#008080;"> 54</span>             wordApp.Visible = <span style="color:#0000ff;">true</span>;<span style="color:#008000;">//</span><span style="color:#008000;">使文档可见,调试用</span> <span style="color:#008080;"> 55</span>             wordApp.DisplayAlerts =<span style="color:#000000;"> Word.WdAlertLevel.wdAlertsNone;
</span><span style="color:#008080;"> 56</span> <span style="color:#0000ff;">object</span> file =<span style="color:#000000;"> templateFile;
</span><span style="color:#008080;"> 57</span>             wordDoc = wordApp.Documents.Open(<span style="color:#0000ff;">ref</span> file, ReadOnly: <span style="color:#0000ff;">false</span><span style="color:#000000;">);
</span><span style="color:#008080;"> 58</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 59</span> <span style="color:#000000;">        }
</span><span style="color:#008080;"> 60</span> <span style="color:#008080;"> 61</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;"> 62</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 为指定区域写入数据
</span><span style="color:#008080;"> 63</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;"> 64</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="element"></span> <span style="color:#008080;"> 65</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;"> 66</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span><span style="color:#000000;"> SetContent(WordElement element)
</span><span style="color:#008080;"> 67</span> <span style="color:#000000;">        {
</span><span style="color:#008080;"> 68</span> <span style="color:#0000ff;">string</span> currBookMarkName = <span style="color:#0000ff;">string</span><span style="color:#000000;">.Empty;
</span><span style="color:#008080;"> 69</span> <span style="color:#0000ff;">string</span> startWith = <span style="color:#800000;">&quot;</span><span style="color:#800000;">loop_</span><span style="color:#800000;">&quot;</span> + (element.Level + <span style="color:#800080;">1</span>).ToString() + <span style="color:#800000;">&quot;</span><span style="color:#800000;"><em></em></span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 70</span> <span style="color:#0000ff;">foreach</span> (Word.Bookmark item <span style="color:#0000ff;">in</span><span style="color:#000000;"> element.Range.Bookmarks)
</span><span style="color:#008080;"> 71</span> <span style="color:#000000;">            {
</span><span style="color:#008080;"> 72</span>                 currBookMarkName =<span style="color:#000000;"> item.Name;
</span><span style="color:#008080;"> 73</span> <span style="color:#008080;"> 74</span> <span style="color:#0000ff;">if</span> (currBookMarkName.StartsWith(startWith) &amp;&amp; (!<span style="color:#000000;">currBookMarkName.Equals(element.ElementName)))
</span><span style="color:#008080;"> 75</span> <span style="color:#000000;">                {
</span><span style="color:#008080;"> 76</span>                     SetLoop(<span style="color:#0000ff;">new</span><span style="color:#000000;"> WordElement(item.Range, currBookMarkName, element.DataRow, element.GroupBy));
</span><span style="color:#008080;"> 77</span> <span style="color:#000000;">                }
</span><span style="color:#008080;"> 78</span> <span style="color:#008080;"> 79</span> <span style="color:#000000;">            }
</span><span style="color:#008080;"> 80</span> <span style="color:#008080;"> 81</span> <span style="color:#000000;">            SetLabel(element);
</span><span style="color:#008080;"> 82</span> <span style="color:#008080;"> 83</span> <span style="color:#000000;">            SetTable(element);
</span><span style="color:#008080;"> 84</span> <span style="color:#008080;"> 85</span> <span style="color:#000000;">            SetChart(element);
</span><span style="color:#008080;"> 86</span> <span style="color:#008080;"> 87</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;"> 88</span> <span style="color:#000000;">        }
</span><span style="color:#008080;"> 89</span> <span style="color:#008080;"> 90</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;"> 91</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 处理循环
</span><span style="color:#008080;"> 92</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;"> 93</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="element"></span> <span style="color:#008080;"> 94</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;"> 95</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span><span style="color:#000000;"> SetLoop(WordElement element)
</span><span style="color:#008080;"> 96</span> <span style="color:#000000;">        {
</span><span style="color:#008080;"> 97</span>             DataRow[] dataRows =<span style="color:#000000;"> dataSource.Tables[element.TableIndex].Select(element.GroupByString);
</span><span style="color:#008080;"> 98</span> <span style="color:#0000ff;">int</span> count =<span style="color:#000000;"> dataRows.Count();
</span><span style="color:#008080;"> 99</span> <span style="color:#000000;">            element.Range.Select();
</span><span style="color:#008080;">100</span> <span style="color:#008080;">101</span> <span style="color:#008000;">//</span><span style="color:#008000;">第0行作为模板  先从1开始  循环后处理0行;</span> <span style="color:#008080;">102</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> i = <span style="color:#800080;">0</span>; i &lt; count; i++<span style="color:#000000;">)
</span><span style="color:#008080;">103</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">104</span> <span style="color:#008080;">105</span>                 element.Range.Copy();  <span style="color:#008000;">//</span><span style="color:#008000;">模板loop复制</span> <span style="color:#008080;">106</span>                 wordApp.Selection.InsertParagraphAfter();<span style="color:#008000;">//</span><span style="color:#008000;">换行 不会清除选中的内容,TypeParagraph 等同于回车,若当前有选中内容会被清除. TypeParagraph 会跳到下一行,InsertParagraphAfter不会, 所以movedown一下.</span> <span style="color:#008080;">107</span>                 wordApp.Selection.MoveDown(<span style="color:#0000ff;">ref</span><span style="color:#000000;"> line, Missing.Value, Missing.Value);
</span><span style="color:#008080;">108</span>                 wordApp.Selection.Paste(); <span style="color:#008000;">//</span><span style="color:#008000;">换行后粘贴复制内容</span> <span style="color:#008080;">109</span> <span style="color:#0000ff;">int</span> offset = wordApp.Selection.Range.End - element.Range.End; <span style="color:#008000;">//</span><span style="color:#008000;">计算偏移量
</span><span style="color:#008080;">110</span> <span style="color:#008080;">111</span> <span style="color:#008000;">//</span><span style="color:#008000;">复制书签,书签名 = 模板书签名 + 复制次数</span> <span style="color:#008080;">112</span> <span style="color:#0000ff;">foreach</span> (Word.Bookmark subBook <span style="color:#0000ff;">in</span><span style="color:#000000;"> element.Range.Bookmarks)
</span><span style="color:#008080;">113</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">114</span> <span style="color:#0000ff;">if</span><span style="color:#000000;"> (subBook.Name.Equals(element.ElementName))
</span><span style="color:#008080;">115</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">116</span> <span style="color:#0000ff;">continue</span><span style="color:#000000;">;
</span><span style="color:#008080;">117</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">118</span> <span style="color:#008080;">119</span>                     wordApp.Selection.Bookmarks.Add(subBook.Name + <span style="color:#800000;">&quot;</span><span style="color:#800000;"></span><span style="color:#800000;">&quot;</span> + i.ToString(), wordDoc.Range(subBook.Start + offset, subBook.End +<span style="color:#000000;"> offset));
</span><span style="color:#008080;">120</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">121</span> <span style="color:#008080;">122</span>                 SetContent(<span style="color:#0000ff;">new</span> WordElement(wordDoc.Range(wordApp.Selection.Range.End - (element.Range.End - element.Range.Start), wordApp.Selection.Range.End), element.ElementName + <span style="color:#800000;">&quot;</span><span style="color:#800000;"><em></em></span><span style="color:#800000;">&quot;</span> +<span style="color:#000000;"> i.ToString(), dataRows[i], element.GroupBy));
</span><span style="color:#008080;">123</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">124</span> <span style="color:#008080;">125</span> <span style="color:#000000;">            element.Range.Delete();
</span><span style="color:#008080;">126</span> <span style="color:#008080;">127</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;">128</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">129</span> <span style="color:#008080;">130</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">131</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 处理简单Label
</span><span style="color:#008080;">132</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">133</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="element"></span> <span style="color:#008080;">134</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;">135</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span><span style="color:#000000;"> SetLabel(WordElement element)
</span><span style="color:#008080;">136</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">137</span> <span style="color:#0000ff;">if</span> (element.Range.Bookmarks != <span style="color:#0000ff;">null</span> &amp;&amp; element.Range.Bookmarks.Count &gt; <span style="color:#800080;">0</span><span style="color:#000000;">)
</span><span style="color:#008080;">138</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">139</span> <span style="color:#0000ff;">string</span> startWith = <span style="color:#800000;">&quot;</span><span style="color:#800000;">label</span><span style="color:#800000;">&quot;</span> + element.Level.ToString() + <span style="color:#800000;">&quot;</span><span style="color:#800000;"><em></em></span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">140</span> <span style="color:#0000ff;">string</span> bookMarkName = <span style="color:#0000ff;">string</span><span style="color:#000000;">.Empty;
</span><span style="color:#008080;">141</span> <span style="color:#0000ff;">foreach</span> (Word.Bookmark item <span style="color:#0000ff;">in</span><span style="color:#000000;"> element.Range.Bookmarks)
</span><span style="color:#008080;">142</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">143</span>                     bookMarkName =<span style="color:#000000;"> item.Name;
</span><span style="color:#008080;">144</span> <span style="color:#008080;">145</span> <span style="color:#0000ff;">if</span><span style="color:#000000;"> (bookMarkName.StartsWith(startWith))
</span><span style="color:#008080;">146</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">147</span>                         bookMarkName =<span style="color:#000000;"> WordElement.GetName(bookMarkName);
</span><span style="color:#008080;">148</span> <span style="color:#008080;">149</span>                         item.Range.Text =<span style="color:#000000;"> element.DataRow[bookMarkName].ToString();
</span><span style="color:#008080;">150</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">151</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">152</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">153</span> <span style="color:#008080;">154</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;">155</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">156</span> <span style="color:#008080;">157</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">158</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 填充Table
</span><span style="color:#008080;">159</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">160</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="element"></span> <span style="color:#008080;">161</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;">162</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span><span style="color:#000000;"> SetTable(WordElement element)
</span><span style="color:#008080;">163</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">164</span> <span style="color:#0000ff;">if</span> (element.Range.Tables != <span style="color:#0000ff;">null</span> &amp;&amp; element.Range.Tables.Count &gt; <span style="color:#800080;">0</span><span style="color:#000000;">)
</span><span style="color:#008080;">165</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">166</span> <span style="color:#0000ff;">string</span> startWith = <span style="color:#800000;">&quot;</span><span style="color:#800000;">table</span><span style="color:#800000;">&quot;</span> + element.Level.ToString() + <span style="color:#800000;">&quot;</span><span style="color:#800000;"><em></em></span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">167</span> <span style="color:#0000ff;">foreach</span> (Word.Table table <span style="color:#0000ff;">in</span><span style="color:#000000;"> element.Range.Tables)
</span><span style="color:#008080;">168</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">169</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">string</span>.IsNullOrEmpty(table.Title) &amp;&amp;<span style="color:#000000;"> table.Title.StartsWith(startWith))
</span><span style="color:#008080;">170</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">171</span>                         WordElement tableElement = <span style="color:#0000ff;">new</span> WordElement(<span style="color:#0000ff;">null</span><span style="color:#000000;">, table.Title, element.DataRow);
</span><span style="color:#008080;">172</span> <span style="color:#008080;">173</span>                         TableConfig config = <span style="color:#0000ff;">new</span><span style="color:#000000;"> TableConfig(table.Descr);
</span><span style="color:#008080;">174</span> <span style="color:#008080;">175</span> <span style="color:#0000ff;">object</span> dataRowTemplate =<span style="color:#000000;"> table.Rows[config.DataRow];
</span><span style="color:#008080;">176</span>                         Word.Row SummaryRow = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;">177</span>                         DataRow SummaryDataRow = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;">178</span>                         DataTable dt =<span style="color:#000000;"> dataSource.Tables[tableElement.TableIndex];
</span><span style="color:#008080;">179</span>                         DataRow[] dataRows =<span style="color:#000000;"> dataSource.Tables[tableElement.TableIndex].Select(tableElement.GroupByString); ;
</span><span style="color:#008080;">180</span> <span style="color:#008080;">181</span> <span style="color:#0000ff;">if</span> (config.SummaryRow &gt; <span style="color:#800080;">0</span><span style="color:#000000;">)
</span><span style="color:#008080;">182</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">183</span>                             SummaryRow =<span style="color:#000000;"> table.Rows[config.SummaryRow];
</span><span style="color:#008080;">184</span>                             SummaryDataRow = dt.Select(<span style="color:#0000ff;">string</span>.IsNullOrEmpty(tableElement.GroupByString) ? config.SummaryFilter : tableElement.GroupByString + <span style="color:#800000;">&quot;</span><span style="color:#800000;"> and  </span><span style="color:#800000;">&quot;</span> +<span style="color:#000000;"> config.SummaryFilter).FirstOrDefault();
</span><span style="color:#008080;">185</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">186</span> <span style="color:#008080;">187</span> <span style="color:#0000ff;">foreach</span> (DataRow row <span style="color:#0000ff;">in</span><span style="color:#000000;"> dataRows)
</span><span style="color:#008080;">188</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">189</span> <span style="color:#0000ff;">if</span> (row ==<span style="color:#000000;"> SummaryDataRow)
</span><span style="color:#008080;">190</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">191</span> <span style="color:#0000ff;">continue</span><span style="color:#000000;">;
</span><span style="color:#008080;">192</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">193</span> <span style="color:#008080;">194</span>                             Word.Row newRow = table.Rows.Add(<span style="color:#0000ff;">ref</span><span style="color:#000000;"> dataRowTemplate);
</span><span style="color:#008080;">195</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> j = <span style="color:#800080;">0</span>; j &lt; table.Columns.Count; j++<span style="color:#000000;">)
</span><span style="color:#008080;">196</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">197</span>                                 newRow.Cells[j + <span style="color:#800080;">1</span>].Range.Text =<span style="color:#000000;"> row[j].ToString(); ;
</span><span style="color:#008080;">198</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">199</span> <span style="color:#008080;">200</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">201</span> <span style="color:#008080;">202</span> <span style="color:#000000;">                        ((Word.Row)dataRowTemplate).Delete();
</span><span style="color:#008080;">203</span> <span style="color:#008080;">204</span> <span style="color:#0000ff;">if</span> (config.SummaryRow &gt; <span style="color:#800080;">0</span> &amp;&amp; SummaryDataRow != <span style="color:#0000ff;">null</span><span style="color:#000000;">)
</span><span style="color:#008080;">205</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">206</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> j = <span style="color:#800080;">0</span>; j &lt; SummaryRow.Cells.Count; j++<span style="color:#000000;">)
</span><span style="color:#008080;">207</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">208</span> <span style="color:#0000ff;">string</span> temp = SummaryRow.Cells[j + <span style="color:#800080;">1</span>].Range.Text.Trim().Replace(<span style="color:#800000;">&quot;</span><span style="color:#800000;">\r\a</span><span style="color:#800000;">&quot;</span>, <span style="color:#800000;">&quot;&quot;</span><span style="color:#000000;">);
</span><span style="color:#008080;">209</span> <span style="color:#008080;">210</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">string</span>.IsNullOrEmpty(temp) &amp;&amp; temp.Length &gt; <span style="color:#800080;">2</span> &amp;&amp; dt.Columns.Contains(temp.Substring(<span style="color:#800080;">1</span>, temp.Length - <span style="color:#800080;">2</span><span style="color:#000000;">)))
</span><span style="color:#008080;">211</span> <span style="color:#000000;">                                {
</span><span style="color:#008080;">212</span>                                     SummaryRow.Cells[j + <span style="color:#800080;">1</span>].Range.Text = SummaryDataRow[temp.Substring(<span style="color:#800080;">1</span>, temp.Length - <span style="color:#800080;">2</span><span style="color:#000000;">)].ToString();
</span><span style="color:#008080;">213</span> <span style="color:#000000;">                                }
</span><span style="color:#008080;">214</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">215</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">216</span> <span style="color:#008080;">217</span>                         table.Title =<span style="color:#000000;"> tableElement.Name;
</span><span style="color:#008080;">218</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">219</span> <span style="color:#008080;">220</span> <span style="color:#008080;">221</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">222</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">223</span> <span style="color:#008080;">224</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;">225</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">226</span> <span style="color:#008080;">227</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">228</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 处理图表
</span><span style="color:#008080;">229</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">230</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="element"></span> <span style="color:#008080;">231</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;">232</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span><span style="color:#000000;"> SetChart(WordElement element)
</span><span style="color:#008080;">233</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">234</span> <span style="color:#0000ff;">if</span> (element.Range.InlineShapes != <span style="color:#0000ff;">null</span> &amp;&amp; element.Range.InlineShapes.Count &gt; <span style="color:#800080;">0</span><span style="color:#000000;">)
</span><span style="color:#008080;">235</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">236</span>                 List&lt;Word.InlineShape&gt; chartList = element.Range.InlineShapes.Cast&lt;Word.InlineShape&gt;().Where(m =&gt; m.Type ==<span style="color:#000000;"> Word.WdInlineShapeType.wdInlineShapeChart).ToList();
</span><span style="color:#008080;">237</span> <span style="color:#0000ff;">string</span> startWith = <span style="color:#800000;">&quot;</span><span style="color:#800000;">chart</span><span style="color:#800000;">&quot;</span> + element.Level.ToString() + <span style="color:#800000;">&quot;</span><span style="color:#800000;"><em></em></span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">238</span> <span style="color:#0000ff;">foreach</span> (Word.InlineShape item <span style="color:#0000ff;">in</span><span style="color:#000000;"> chartList)
</span><span style="color:#008080;">239</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">240</span>                     Word.Chart chart =<span style="color:#000000;"> item.Chart;
</span><span style="color:#008080;">241</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">string</span>.IsNullOrEmpty(chart.ChartTitle.Text) &amp;&amp;<span style="color:#000000;"> chart.ChartTitle.Text.StartsWith(startWith))
</span><span style="color:#008080;">242</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">243</span>                         WordElement chartElement = <span style="color:#0000ff;">new</span> WordElement(<span style="color:#0000ff;">null</span><span style="color:#000000;">, chart.ChartTitle.Text, element.DataRow);
</span><span style="color:#008080;">244</span> <span style="color:#008080;">245</span>                         DataTable dataTable =<span style="color:#000000;"> dataSource.Tables[chartElement.TableIndex];
</span><span style="color:#008080;">246</span>                         DataRow[] dataRows =<span style="color:#000000;"> dataTable.Select(chartElement.GroupByString);
</span><span style="color:#008080;">247</span> <span style="color:#008080;">248</span> <span style="color:#0000ff;">int</span> columnCount =<span style="color:#000000;"> dataTable.Columns.Count;
</span><span style="color:#008080;">249</span>                         List&lt;<span style="color:#0000ff;">int</span>&gt; columns = <span style="color:#0000ff;">new</span> List&lt;<span style="color:#0000ff;">int</span>&gt;<span style="color:#000000;">();
</span><span style="color:#008080;">250</span> <span style="color:#008080;">251</span> <span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">var</span> dr <span style="color:#0000ff;">in</span><span style="color:#000000;"> dataRows)
</span><span style="color:#008080;">252</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">253</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> i = chartElement.ColumnStart == -<span style="color:#800080;">1</span> ? <span style="color:#800080;">0</span> : chartElement.ColumnStart - <span style="color:#800080;">1</span>; i &lt; (chartElement.ColumnEnd == -<span style="color:#800080;">1</span> ? columnCount : chartElement.ColumnEnd); i++<span style="color:#000000;">)
</span><span style="color:#008080;">254</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">255</span> <span style="color:#0000ff;">if</span> (columns.Contains(i) || dr[i] == <span style="color:#0000ff;">null</span> || <span style="color:#0000ff;">string</span><span style="color:#000000;">.IsNullOrEmpty(dr[i].ToString()))
</span><span style="color:#008080;">256</span> <span style="color:#000000;">                                {
</span><span style="color:#008080;">257</span> <span style="color:#008080;">258</span> <span style="color:#000000;">                                }
</span><span style="color:#008080;">259</span> <span style="color:#0000ff;">else</span> <span style="color:#008080;">260</span> <span style="color:#000000;">                                {
</span><span style="color:#008080;">261</span> <span style="color:#000000;">                                    columns.Add(i);
</span><span style="color:#008080;">262</span> <span style="color:#000000;">                                }
</span><span style="color:#008080;">263</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">264</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">265</span> <span style="color:#000000;">                        columns.Sort();
</span><span style="color:#008080;">266</span>                         columnCount =<span style="color:#000000;"> columns.Count;
</span><span style="color:#008080;">267</span> <span style="color:#0000ff;">int</span> rowsCount =<span style="color:#000000;"> dataRows.Length;
</span><span style="color:#008080;">268</span> <span style="color:#008080;">269</span>                         Word.ChartData chartData =<span style="color:#000000;"> chart.ChartData;
</span><span style="color:#008080;">270</span> <span style="color:#008080;">271</span> <span style="color:#008000;">//</span><span style="color:#008000;">chartData.Activate();
</span><span style="color:#008080;">272</span> <span style="color:#008000;">//</span><span style="color:#008000;">此处有个比较疑惑的问题, 不执行此条,生成的报告中的图表无法再次右键编辑数据. 执行后可以, 但有两个问题就是第一会弹出Excel框, 处理完后会自动关闭. 第二部分chart的数据range设置总不对
</span><span style="color:#008080;">273</span> <span style="color:#008000;">//</span><span style="color:#008000;">不知道是不是版本的问题, 谁解决了分享一下,谢谢</span> <span style="color:#008080;">274</span> <span style="color:#008080;">275</span>                         Excel.Workbook dataWorkbook =<span style="color:#000000;"> (Excel.Workbook)chartData.Workbook;
</span><span style="color:#008080;">276</span>                         dataWorkbook.Application.Visible = <span style="color:#0000ff;">false</span><span style="color:#000000;">;
</span><span style="color:#008080;">277</span> <span style="color:#008080;">278</span>                         Excel.Worksheet dataSheet = (Excel.Worksheet)dataWorkbook.Worksheets[<span style="color:#800080;">1</span><span style="color:#000000;">];
</span><span style="color:#008080;">279</span> <span style="color:#008000;">//</span><span style="color:#008000;">设定范围  </span> <span style="color:#008080;">280</span> <span style="color:#0000ff;">string</span> a = (chartElement.ColumnNameForHead ? rowsCount + <span style="color:#800080;">1</span> : rowsCount) + <span style="color:#800000;">&quot;</span><span style="color:#800000;">|</span><span style="color:#800000;">&quot;</span> +<span style="color:#000000;"> columnCount;
</span><span style="color:#008080;">281</span> <span style="color:#000000;">                        Console.WriteLine(a);
</span><span style="color:#008080;">282</span> <span style="color:#008080;">283</span>                         Excel.Range tRange = dataSheet.Range[<span style="color:#800000;">&quot;</span><span style="color:#800000;">A1</span><span style="color:#800000;">&quot;</span>, dataSheet.Cells[(chartElement.ColumnNameForHead ? rowsCount + <span style="color:#800080;">1</span><span style="color:#000000;"> : rowsCount), columnCount]];
</span><span style="color:#008080;">284</span>                         Excel.ListObject tbl1 = dataSheet.ListObjects[<span style="color:#800080;">1</span><span style="color:#000000;">];
</span><span style="color:#008080;">285</span> <span style="color:#008000;">//</span><span style="color:#008000;">dataSheet.ListObjects[1].Delete(); </span><span style="color:#008000;">//</span><span style="color:#008000;">想过重新删除再添加  这样 原有数据清掉了, 但觉得性能应该会有所下降
</span><span style="color:#008080;">286</span> <span style="color:#008000;">//</span><span style="color:#008000;">Excel.ListObject tbl1 = dataSheet.ListObjects.AddEx();</span> <span style="color:#008080;">287</span> <span style="color:#000000;">                        tbl1.Resize(tRange);
</span><span style="color:#008080;">288</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> j = <span style="color:#800080;">0</span>; j &lt; rowsCount; j++<span style="color:#000000;">)
</span><span style="color:#008080;">289</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">290</span>                             DataRow row =<span style="color:#000000;"> dataRows[j];
</span><span style="color:#008080;">291</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> k = <span style="color:#800080;">0</span>; k &lt; columnCount; k++<span style="color:#000000;">)
</span><span style="color:#008080;">292</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">293</span>                                 dataSheet.Cells[j + <span style="color:#800080;">2</span>, k + <span style="color:#800080;">1</span>].FormulaR1C1 =<span style="color:#000000;"> row[columns[k]];
</span><span style="color:#008080;">294</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">295</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">296</span> <span style="color:#008080;">297</span> <span style="color:#0000ff;">if</span><span style="color:#000000;"> (chartElement.ColumnNameForHead)
</span><span style="color:#008080;">298</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">299</span> <span style="color:#0000ff;">for</span> (<span style="color:#0000ff;">int</span> k = <span style="color:#800080;">0</span>; k &lt; columns.Count; k++<span style="color:#000000;">)
</span><span style="color:#008080;">300</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">301</span>                                 dataSheet.Cells[<span style="color:#800080;">1</span>, k + <span style="color:#800080;">1</span>].FormulaR1C1 =<span style="color:#000000;"> dataTable.Columns[columns[k]].ColumnName;
</span><span style="color:#008080;">302</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">303</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">304</span>                         chart.ChartTitle.Text =<span style="color:#000000;"> chartElement.Name;
</span><span style="color:#008080;">305</span> <span style="color:#008000;">//</span><span style="color:#008000;">dataSheet.Application.Quit();</span> <span style="color:#008080;">306</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">307</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">308</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">309</span> <span style="color:#008080;">310</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;">311</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">312</span> <span style="color:#008080;">313</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">314</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 更新目录
</span><span style="color:#008080;">315</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">316</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;">317</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span><span style="color:#000000;"> UpdateTablesOfContents()
</span><span style="color:#008080;">318</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">319</span> <span style="color:#0000ff;">foreach</span> (Word.TableOfContents item <span style="color:#0000ff;">in</span><span style="color:#000000;"> wordDoc.TablesOfContents)
</span><span style="color:#008080;">320</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">321</span> <span style="color:#000000;">                item.Update();
</span><span style="color:#008080;">322</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">323</span> <span style="color:#008080;">324</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;">325</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">326</span> <span style="color:#008080;">327</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">328</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 保存文件
</span><span style="color:#008080;">329</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">330</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="newFilePath"></span> <span style="color:#008080;">331</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="newFileName"></span> <span style="color:#008080;">332</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="saveFormat"></span> <span style="color:#008080;">333</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><returns></returns></span> <span style="color:#008080;">334</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">bool</span> SaveFile(<span style="color:#0000ff;">string</span> newFilePath, <span style="color:#0000ff;">ref</span> <span style="color:#0000ff;">string</span> newFileName, <span style="color:#0000ff;">int</span> saveFormat = <span style="color:#800080;">16</span><span style="color:#000000;">)
</span><span style="color:#008080;">335</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">336</span> <span style="color:#0000ff;">if</span> (<span style="color:#0000ff;">string</span><span style="color:#000000;">.IsNullOrEmpty(newFileName))
</span><span style="color:#008080;">337</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">338</span>                 newFileName = DateTime.Now.ToString(<span style="color:#800000;">&quot;</span><span style="color:#800000;">yyyyMMddHHmmss</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">);
</span><span style="color:#008080;">339</span> <span style="color:#008080;">340</span> <span style="color:#0000ff;">switch</span><span style="color:#000000;"> (saveFormat)
</span><span style="color:#008080;">341</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">342</span> <span style="color:#0000ff;">case</span> <span style="color:#800080;">0</span>:<span style="color:#008000;">//</span><span style="color:#008000;"> Word.WdSaveFormat.wdFormatDocument</span> <span style="color:#008080;">343</span>                         newFileName += <span style="color:#800000;">&quot;</span><span style="color:#800000;">.doc</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">344</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">345</span> <span style="color:#0000ff;">case</span> <span style="color:#800080;">16</span>:<span style="color:#008000;">//</span><span style="color:#008000;"> Word.WdSaveFormat.wdFormatDocumentDefault</span> <span style="color:#008080;">346</span>                         newFileName += <span style="color:#800000;">&quot;</span><span style="color:#800000;">.docx</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">347</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">348</span> <span style="color:#0000ff;">case</span> <span style="color:#800080;">17</span>:<span style="color:#008000;">//</span><span style="color:#008000;"> Word.WdSaveFormat.wdFormatPDF</span> <span style="color:#008080;">349</span>                         newFileName += <span style="color:#800000;">&quot;</span><span style="color:#800000;">.pdf</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">350</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">351</span> <span style="color:#0000ff;">default</span><span style="color:#000000;">:
</span><span style="color:#008080;">352</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">353</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">354</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">355</span> <span style="color:#008080;">356</span> <span style="color:#0000ff;">object</span> newfile =<span style="color:#000000;"> Path.Combine(newFilePath, newFileName);
</span><span style="color:#008080;">357</span> <span style="color:#0000ff;">object</span> wdSaveFormat =<span style="color:#000000;"> saveFormat;
</span><span style="color:#008080;">358</span>             wordDoc.SaveAs(<span style="color:#0000ff;">ref</span> newfile, <span style="color:#0000ff;">ref</span><span style="color:#000000;"> wdSaveFormat);
</span><span style="color:#008080;">359</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">true</span><span style="color:#000000;">;
</span><span style="color:#008080;">360</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">361</span> <span style="color:#008080;">362</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">363</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 清理
</span><span style="color:#008080;">364</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">365</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">void</span><span style="color:#000000;"> CloseAndClear()
</span><span style="color:#008080;">366</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">367</span> <span style="color:#0000ff;">if</span> (wordApp == <span style="color:#0000ff;">null</span><span style="color:#000000;">)
</span><span style="color:#008080;">368</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">369</span> <span style="color:#0000ff;">return</span><span style="color:#000000;">;
</span><span style="color:#008080;">370</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">371</span> <span style="color:#000000;">            wordDoc.Close(Word.WdSaveOptions.wdDoNotSaveChanges);
</span><span style="color:#008080;">372</span> <span style="color:#000000;">            wordApp.Quit(Word.WdSaveOptions.wdDoNotSaveChanges);
</span><span style="color:#008080;">373</span> <span style="color:#000000;">            System.Runtime.InteropServices.Marshal.ReleaseComObject(wordDoc);
</span><span style="color:#008080;">374</span> <span style="color:#000000;">            System.Runtime.InteropServices.Marshal.ReleaseComObject(wordApp);
</span><span style="color:#008080;">375</span>             wordDoc = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;">376</span>             wordApp = <span style="color:#0000ff;">null</span><span style="color:#000000;">;
</span><span style="color:#008080;">377</span> <span style="color:#000000;">            GC.Collect();
</span><span style="color:#008080;">378</span>             KillProcess(<span style="color:#800000;">&quot;</span><span style="color:#800000;">Excel</span><span style="color:#800000;">&quot;</span>, <span style="color:#800000;">&quot;</span><span style="color:#800000;">WINWORD</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">);
</span><span style="color:#008080;">379</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">380</span> <span style="color:#008080;">381</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">382</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 杀进程..
</span><span style="color:#008080;">383</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">384</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><param name="processNames"></span> <span style="color:#008080;">385</span> <span style="color:#0000ff;">private</span> <span style="color:#0000ff;">void</span> KillProcess(<span style="color:#0000ff;">params</span> <span style="color:#0000ff;">string</span><span style="color:#000000;">[] processNames)
</span><span style="color:#008080;">386</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">387</span> <span style="color:#008000;">//</span><span style="color:#008000;">Process myproc = new Process();
</span><span style="color:#008080;">388</span> <span style="color:#008000;">//</span><span style="color:#008000;">得到所有打开的进程  </span> <span style="color:#008080;">389</span> <span style="color:#0000ff;">try</span> <span style="color:#008080;">390</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">391</span> <span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> name <span style="color:#0000ff;">in</span><span style="color:#000000;"> processNames)
</span><span style="color:#008080;">392</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">393</span> <span style="color:#0000ff;">foreach</span> (Process thisproc <span style="color:#0000ff;">in</span><span style="color:#000000;"> Process.GetProcessesByName(name))
</span><span style="color:#008080;">394</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">395</span> <span style="color:#0000ff;">if</span> (!<span style="color:#000000;">thisproc.CloseMainWindow())
</span><span style="color:#008080;">396</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">397</span> <span style="color:#0000ff;">if</span> (thisproc != <span style="color:#0000ff;">null</span><span style="color:#000000;">)
</span><span style="color:#008080;">398</span> <span style="color:#000000;">                                thisproc.Kill();
</span><span style="color:#008080;">399</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">400</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">401</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">402</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">403</span> <span style="color:#0000ff;">catch</span><span style="color:#000000;"> (Exception)
</span><span style="color:#008080;">404</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">405</span> <span style="color:#008000;">//</span><span style="color:#008000;">throw Exc;
</span><span style="color:#008080;">406</span> <span style="color:#008000;">//</span><span style="color:#008000;"> msg.Text+=  &quot;杀死&quot;  +  processName  +  &quot;失败！&quot;;  </span> <span style="color:#008080;">407</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">408</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">409</span> <span style="color:#000000;">    }
</span><span style="color:#008080;">410</span> <span style="color:#008080;">411</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">412</span> <span style="color:#808080;">///</span><span style="color:#008000;"> 封装的Word元素
</span><span style="color:#008080;">413</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">414</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">class</span><span style="color:#000000;"> WordElement
</span><span style="color:#008080;">415</span> <span style="color:#000000;">    {
</span><span style="color:#008080;">416</span> <span style="color:#0000ff;">public</span> WordElement(Word.Range range, <span style="color:#0000ff;">string</span> elementName = <span style="color:#800000;">&quot;&quot;</span>, DataRow dataRow = <span style="color:#0000ff;">null</span>, Dictionary&lt;<span style="color:#0000ff;">string</span>, <span style="color:#0000ff;">string</span>&gt; groupBy = <span style="color:#0000ff;">null</span>, <span style="color:#0000ff;">int</span> tableIndex = <span style="color:#800080;">0</span><span style="color:#000000;">)
</span><span style="color:#008080;">417</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">418</span> <span style="color:#0000ff;">this</span>.Range =<span style="color:#000000;"> range;
</span><span style="color:#008080;">419</span> <span style="color:#0000ff;">this</span>.ElementName =<span style="color:#000000;"> elementName;
</span><span style="color:#008080;">420</span> <span style="color:#0000ff;">this</span>.GroupBy =<span style="color:#000000;"> groupBy;
</span><span style="color:#008080;">421</span> <span style="color:#0000ff;">this</span>.DataRow =<span style="color:#000000;"> dataRow;
</span><span style="color:#008080;">422</span> <span style="color:#0000ff;">if</span> (<span style="color:#0000ff;">string</span><span style="color:#000000;">.IsNullOrEmpty(elementName))
</span><span style="color:#008080;">423</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">424</span> <span style="color:#0000ff;">this</span>.Level = <span style="color:#800080;">0</span><span style="color:#000000;">;
</span><span style="color:#008080;">425</span> <span style="color:#0000ff;">this</span>.TableIndex =<span style="color:#000000;"> tableIndex;
</span><span style="color:#008080;">426</span> <span style="color:#0000ff;">this</span>.Name = <span style="color:#0000ff;">string</span><span style="color:#000000;">.Empty;
</span><span style="color:#008080;">427</span> <span style="color:#0000ff;">this</span>.ColumnNameForHead = <span style="color:#0000ff;">false</span><span style="color:#000000;">;
</span><span style="color:#008080;">428</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">429</span> <span style="color:#0000ff;">else</span> <span style="color:#008080;">430</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">431</span> <span style="color:#0000ff;">string</span>[] element = elementName.Split(<span style="color:#800000;">'</span><span style="color:#800000;"></span><span style="color:#800000;">'</span><span style="color:#000000;">);
</span><span style="color:#008080;">432</span> <span style="color:#0000ff;">this</span>.Level = <span style="color:#0000ff;">int</span>.Parse(element[<span style="color:#800080;">1</span><span style="color:#000000;">]);
</span><span style="color:#008080;">433</span> <span style="color:#0000ff;">this</span>.ColumnNameForHead = <span style="color:#0000ff;">false</span><span style="color:#000000;">;
</span><span style="color:#008080;">434</span> <span style="color:#0000ff;">this</span>.ColumnStart = -<span style="color:#800080;">1</span><span style="color:#000000;">;
</span><span style="color:#008080;">435</span> <span style="color:#0000ff;">this</span>.ColumnEnd = -<span style="color:#800080;">1</span><span style="color:#000000;">;
</span><span style="color:#008080;">436</span> <span style="color:#008080;">437</span> <span style="color:#0000ff;">if</span> (element[<span style="color:#800080;">0</span>].Equals(<span style="color:#800000;">&quot;</span><span style="color:#800000;">label</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">))
</span><span style="color:#008080;">438</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">439</span> <span style="color:#0000ff;">this</span>.Name = element[<span style="color:#800080;">2</span><span style="color:#000000;">];
</span><span style="color:#008080;">440</span> <span style="color:#0000ff;">this</span>.TableIndex = <span style="color:#800080;">0</span><span style="color:#000000;">;
</span><span style="color:#008080;">441</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">442</span> <span style="color:#0000ff;">else</span> <span style="color:#008080;">443</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">444</span> <span style="color:#0000ff;">this</span>.Name = element[<span style="color:#800080;">4</span><span style="color:#000000;">];
</span><span style="color:#008080;">445</span> <span style="color:#0000ff;">this</span>.TableIndex = <span style="color:#0000ff;">int</span>.Parse(element[<span style="color:#800080;">2</span>]) - <span style="color:#800080;">1</span><span style="color:#000000;">;
</span><span style="color:#008080;">446</span> <span style="color:#008080;">447</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">string</span>.IsNullOrEmpty(element[<span style="color:#800080;">3</span><span style="color:#000000;">]))
</span><span style="color:#008080;">448</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">449</span> <span style="color:#0000ff;">string</span>[] filters = element[<span style="color:#800080;">3</span>].Split(<span style="color:#0000ff;">new</span> <span style="color:#0000ff;">string</span>[] { <span style="color:#800000;">&quot;</span><span style="color:#800000;">XX</span><span style="color:#800000;">&quot;</span><span style="color:#000000;"> }, StringSplitOptions.RemoveEmptyEntries);
</span><span style="color:#008080;">450</span> <span style="color:#0000ff;">if</span> (<span style="color:#0000ff;">this</span>.GroupBy == <span style="color:#0000ff;">null</span><span style="color:#000000;">)
</span><span style="color:#008080;">451</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">452</span> <span style="color:#0000ff;">this</span>.GroupBy = <span style="color:#0000ff;">new</span> Dictionary&lt;<span style="color:#0000ff;">string</span>, <span style="color:#0000ff;">string</span>&gt;<span style="color:#000000;">();
</span><span style="color:#008080;">453</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">454</span> <span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> item <span style="color:#0000ff;">in</span><span style="color:#000000;"> filters)
</span><span style="color:#008080;">455</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">456</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">this</span><span style="color:#000000;">.GroupBy.Keys.Contains(item))
</span><span style="color:#008080;">457</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">458</span> <span style="color:#0000ff;">this</span><span style="color:#000000;">.GroupBy.Add(item, dataRow[item].ToString());
</span><span style="color:#008080;">459</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">460</span> <span style="color:#008080;">461</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">462</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">463</span> <span style="color:#008080;">464</span> <span style="color:#0000ff;">if</span> (element[<span style="color:#800080;">0</span>].Equals(<span style="color:#800000;">&quot;</span><span style="color:#800000;">chart</span><span style="color:#800000;">&quot;</span>) &amp;&amp; element.Count() &gt; <span style="color:#800080;">5</span><span style="color:#000000;">)
</span><span style="color:#008080;">465</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">466</span> <span style="color:#0000ff;">this</span>.ColumnNameForHead = element[<span style="color:#800080;">5</span>].Equals(<span style="color:#800000;">&quot;</span><span style="color:#800000;">1</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">);
</span><span style="color:#008080;">467</span> <span style="color:#0000ff;">this</span>.ColumnStart = <span style="color:#0000ff;">string</span>.IsNullOrEmpty(element[<span style="color:#800080;">6</span>]) ? -<span style="color:#800080;">1</span> : <span style="color:#0000ff;">int</span>.Parse(element[<span style="color:#800080;">6</span><span style="color:#000000;">]);
</span><span style="color:#008080;">468</span> <span style="color:#0000ff;">this</span>.ColumnEnd = <span style="color:#0000ff;">string</span>.IsNullOrEmpty(element[<span style="color:#800080;">7</span>]) ? -<span style="color:#800080;">1</span> : <span style="color:#0000ff;">int</span>.Parse(element[<span style="color:#800080;">7</span><span style="color:#000000;">]);
</span><span style="color:#008080;">469</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">470</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">471</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">472</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">473</span> <span style="color:#008080;">474</span> <span style="color:#0000ff;">public</span> Word.Range Range { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">475</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> Level { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">476</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> TableIndex { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">477</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">string</span> ElementName { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">478</span> <span style="color:#008080;">479</span> <span style="color:#0000ff;">public</span> DataRow DataRow { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">480</span> <span style="color:#0000ff;">public</span> Dictionary&lt;<span style="color:#0000ff;">string</span>, <span style="color:#0000ff;">string</span>&gt; GroupBy { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">481</span> <span style="color:#008080;">482</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">string</span> Name { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">483</span> <span style="color:#008080;">484</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">bool</span> ColumnNameForHead { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">485</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> ColumnStart { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">486</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> ColumnEnd { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">487</span> <span style="color:#008080;">488</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">string</span><span style="color:#000000;"> GroupByString
</span><span style="color:#008080;">489</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">490</span> <span style="color:#0000ff;">get</span> <span style="color:#008080;">491</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">492</span> <span style="color:#0000ff;">if</span> (GroupBy == <span style="color:#0000ff;">null</span> || GroupBy.Count == <span style="color:#800080;">0</span><span style="color:#000000;">)
</span><span style="color:#008080;">493</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">494</span> <span style="color:#0000ff;">return</span> <span style="color:#0000ff;">string</span><span style="color:#000000;">.Empty;
</span><span style="color:#008080;">495</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">496</span> <span style="color:#008080;">497</span> <span style="color:#0000ff;">string</span> rtn = <span style="color:#0000ff;">string</span><span style="color:#000000;">.Empty;
</span><span style="color:#008080;">498</span> <span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> key <span style="color:#0000ff;">in</span> <span style="color:#0000ff;">this</span><span style="color:#000000;">.GroupBy.Keys)
</span><span style="color:#008080;">499</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">500</span>                     rtn += <span style="color:#800000;">&quot;</span><span style="color:#800000;">and </span><span style="color:#800000;">&quot;</span> + key + <span style="color:#800000;">&quot;</span><span style="color:#800000;"> = '</span><span style="color:#800000;">&quot;</span> + GroupBy[key] + <span style="color:#800000;">&quot;</span><span style="color:#800000;">' </span><span style="color:#800000;">&quot;</span><span style="color:#000000;">;
</span><span style="color:#008080;">501</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">502</span> <span style="color:#0000ff;">return</span> rtn.Substring(<span style="color:#800080;">3</span><span style="color:#000000;">);
</span><span style="color:#008080;">503</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">504</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">505</span> <span style="color:#008080;">506</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">static</span> <span style="color:#0000ff;">string</span> GetName(<span style="color:#0000ff;">string</span><span style="color:#000000;"> elementName)
</span><span style="color:#008080;">507</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">508</span> <span style="color:#0000ff;">string</span>[] element = elementName.Split(<span style="color:#800000;">'</span><span style="color:#800000;">_</span><span style="color:#800000;">'</span><span style="color:#000000;">);
</span><span style="color:#008080;">509</span> <span style="color:#008080;">510</span> <span style="color:#008080;">511</span> <span style="color:#0000ff;">if</span> (element[<span style="color:#800080;">0</span>].Equals(<span style="color:#800000;">&quot;</span><span style="color:#800000;">label</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">))
</span><span style="color:#008080;">512</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">513</span> <span style="color:#0000ff;">return</span> element[<span style="color:#800080;">2</span><span style="color:#000000;">];
</span><span style="color:#008080;">514</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">515</span> <span style="color:#0000ff;">else</span> <span style="color:#008080;">516</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">517</span> <span style="color:#0000ff;">return</span> element[<span style="color:#800080;">4</span><span style="color:#000000;">];
</span><span style="color:#008080;">518</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">519</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">520</span> <span style="color:#000000;">    }
</span><span style="color:#008080;">521</span> <span style="color:#008080;">522</span> <span style="color:#808080;">///</span> <span style="color:#808080;"><summary></summary></span> <span style="color:#008080;">523</span> <span style="color:#808080;">///</span><span style="color:#008000;"> Table配置项
</span><span style="color:#008080;">524</span> <span style="color:#808080;">///</span> <span style="color:#808080;"></span> <span style="color:#008080;">525</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">class</span><span style="color:#000000;"> TableConfig
</span><span style="color:#008080;">526</span> <span style="color:#000000;">    {
</span><span style="color:#008080;">527</span> <span style="color:#0000ff;">public</span> TableConfig(<span style="color:#0000ff;">string</span> tableDescr = <span style="color:#800000;">&quot;&quot;</span><span style="color:#000000;">)
</span><span style="color:#008080;">528</span> <span style="color:#000000;">        {
</span><span style="color:#008080;">529</span> <span style="color:#0000ff;">this</span>.DataRow = <span style="color:#800080;">2</span><span style="color:#000000;">;
</span><span style="color:#008080;">530</span> <span style="color:#0000ff;">this</span>.SummaryRow = -<span style="color:#800080;">1</span><span style="color:#000000;">;
</span><span style="color:#008080;">531</span> <span style="color:#008080;">532</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">string</span><span style="color:#000000;">.IsNullOrEmpty(tableDescr))
</span><span style="color:#008080;">533</span> <span style="color:#000000;">            {
</span><span style="color:#008080;">534</span> <span style="color:#0000ff;">string</span>[] element = tableDescr.Split(<span style="color:#800000;">'</span><span style="color:#800000;">,</span><span style="color:#800000;">'</span><span style="color:#000000;">);
</span><span style="color:#008080;">535</span> <span style="color:#0000ff;">foreach</span> (<span style="color:#0000ff;">string</span> item <span style="color:#0000ff;">in</span><span style="color:#000000;"> element)
</span><span style="color:#008080;">536</span> <span style="color:#000000;">                {
</span><span style="color:#008080;">537</span> <span style="color:#0000ff;">if</span> (!<span style="color:#0000ff;">string</span><span style="color:#000000;">.IsNullOrEmpty(item))
</span><span style="color:#008080;">538</span> <span style="color:#000000;">                    {
</span><span style="color:#008080;">539</span> <span style="color:#0000ff;">string</span>[] configs = item.Split(<span style="color:#800000;">'</span><span style="color:#800000;">:</span><span style="color:#800000;">'</span><span style="color:#000000;">);
</span><span style="color:#008080;">540</span> <span style="color:#0000ff;">if</span> (configs.Length == <span style="color:#800080;">2</span><span style="color:#000000;">)
</span><span style="color:#008080;">541</span> <span style="color:#000000;">                        {
</span><span style="color:#008080;">542</span> <span style="color:#0000ff;">switch</span> (configs[<span style="color:#800080;">0</span><span style="color:#000000;">].ToLower())
</span><span style="color:#008080;">543</span> <span style="color:#000000;">                            {
</span><span style="color:#008080;">544</span> <span style="color:#0000ff;">case</span> <span style="color:#800000;">&quot;</span><span style="color:#800000;">data</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">:
</span><span style="color:#008080;">545</span> <span style="color:#0000ff;">case</span> <span style="color:#800000;">&quot;</span><span style="color:#800000;">d</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">:
</span><span style="color:#008080;">546</span> <span style="color:#0000ff;">this</span>.DataRow = <span style="color:#0000ff;">int</span>.Parse(configs[<span style="color:#800080;">1</span><span style="color:#000000;">]);
</span><span style="color:#008080;">547</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">548</span> <span style="color:#0000ff;">case</span> <span style="color:#800000;">&quot;</span><span style="color:#800000;">summary</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">:
</span><span style="color:#008080;">549</span> <span style="color:#0000ff;">case</span> <span style="color:#800000;">&quot;</span><span style="color:#800000;">s</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">:
</span><span style="color:#008080;">550</span> <span style="color:#0000ff;">this</span>.SummaryRow = <span style="color:#0000ff;">int</span>.Parse(configs[<span style="color:#800080;">1</span><span style="color:#000000;">]);
</span><span style="color:#008080;">551</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">552</span> <span style="color:#0000ff;">case</span> <span style="color:#800000;">&quot;</span><span style="color:#800000;">summaryfilter</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">:
</span><span style="color:#008080;">553</span> <span style="color:#0000ff;">case</span> <span style="color:#800000;">&quot;</span><span style="color:#800000;">sf</span><span style="color:#800000;">&quot;</span><span style="color:#000000;">:
</span><span style="color:#008080;">554</span> <span style="color:#0000ff;">this</span>.SummaryFilter = configs[<span style="color:#800080;">1</span><span style="color:#000000;">];
</span><span style="color:#008080;">555</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">556</span> <span style="color:#0000ff;">default</span><span style="color:#000000;">:
</span><span style="color:#008080;">557</span> <span style="color:#0000ff;">break</span><span style="color:#000000;">;
</span><span style="color:#008080;">558</span> <span style="color:#000000;">                            }
</span><span style="color:#008080;">559</span> <span style="color:#000000;">                        }
</span><span style="color:#008080;">560</span> <span style="color:#000000;">                    }
</span><span style="color:#008080;">561</span> <span style="color:#000000;">                }
</span><span style="color:#008080;">562</span> <span style="color:#000000;">            }
</span><span style="color:#008080;">563</span> <span style="color:#008080;">564</span> <span style="color:#000000;">        }
</span><span style="color:#008080;">565</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> DataRow { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">566</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">int</span> SummaryRow { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">567</span> <span style="color:#0000ff;">public</span> <span style="color:#0000ff;">string</span> SummaryFilter { <span style="color:#0000ff;">get</span>; <span style="color:#0000ff;">set</span><span style="color:#000000;">; }
</span><span style="color:#008080;">568</span> <span style="color:#000000;">    }
</span><span style="color:#008080;">569</span> }</p></div> <span class="cnblogs_code_collapse">View Code</span></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5c4124d9.js" defer></script><script src="/assets/js/2.5052fd89.js" defer></script><script src="/assets/js/83.6c0ee3d0.js" defer></script>
  </body>
</html>
