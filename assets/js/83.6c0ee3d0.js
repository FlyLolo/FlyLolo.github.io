(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{313:function(t,a,o){"use strict";function l(t,a,o,l,s,c,e,v){var _,n="function"==typeof t?t.options:t;if(a&&(n.render=a,n.staticRenderFns=o,n._compiled=!0),l&&(n.functional=!0),c&&(n._scopeId="data-v-"+c),e?(_=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(e)},n._ssrRegister=_):s&&(_=v?function(){s.call(this,(n.functional?this.parent:this).$root.$options.shadowRoot)}:s),_)if(n.functional){n._injectStyles=_;var r=n.render;n.render=function(t,a){return _.call(a),r(t,a)}}else{var i=n.beforeCreate;n.beforeCreate=i?[].concat(i,_):[_]}return{exports:t,options:n}}o.d(a,"a",(function(){return l}))},450:function(t,a,o){"use strict";o.r(a);var l=o(313),s=Object(l.a)({},(function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("p",[t._v("将很早之前写的一个小组件重新整理优化一下，做成一个通用的功能。适用于导出数据库的结构（表、字段等）到Word或将体检数据自动生成Word版的体检报告等。代码："),o("a",{attrs:{href:"https://github.com/FlyLolo/WordReport",target:"_blank",rel:"noopener noreferrer"}},[t._v("Github"),o("OutboundLink")],1)]),t._v(" "),o("h2",{attrs:{id:"_1-主要需要完成功能"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_1-主要需要完成功能"}},[t._v("#")]),t._v(" 1. 主要需要完成功能:")]),t._v(" "),o("ol",[o("li",[o("p",[t._v("灵活的配置规则及word样式设置（文本、表格、图表、颜色等）.")])]),t._v(" "),o("li",[o("p",[t._v("支持表格.")])]),t._v(" "),o("li",[o("p",[t._v("支持图表.")])]),t._v(" "),o("li",[o("p",[t._v("支持章节内容循环生成.")])]),t._v(" "),o("li",[o("p",[t._v("支持目录.")])])]),t._v(" "),o("p",[t._v("6.支持文档结构图")]),t._v(" "),o("p",[t._v("7.更新指定位置的文字")]),t._v(" "),o("p",[t._v("8.支持pdf导出.")]),t._v(" "),o("p",[t._v("最后结果如下:")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181029144356122-1713299705.png",alt:""}})]),t._v(" "),o("p",[t._v("图一")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181029135957011-62906171.png",alt:""}})]),t._v(" "),o("p",[t._v("图二")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181029140013936-2098987640.png",alt:""}})]),t._v(" "),o("p",[t._v("图三")]),t._v(" "),o("h2",{attrs:{id:"_2-需求分析与实现方式"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_2-需求分析与实现方式"}},[t._v("#")]),t._v(" 2. 需求分析与实现方式")]),t._v(" "),o("p",[t._v("功能主要涉及3个比较重要的部分：数据源、Word样式、配置规则。")]),t._v(" "),o("p",[t._v("为了简单,数据源决定采用一个存储过程返回Dataset的方式, 整张报告的数据来源于此Dataset的多个Datatable.")]),t._v(" "),o("p",[t._v("样式与配置：首先想到的是写一个config文件，所有配置都放到一个文件里，然后将数据按照这个规则生成word。但无疑这样的配置项太多了，关键是“样式”问题，比如字体、颜色、表格宽度.....想想就头大。而且没有“所见即所得”的效果，配置完都不知道啥样。")]),t._v(" "),o("p",[t._v("后来决定采取修改的方式, 先以一个word文件作为模板，在模板中定义好上面提到的“样式”，然后在模板中做一个个标记，然后将数据按照规则更新到对应的标记。")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181029143104735-372624253.png",alt:""}})]),t._v(" "),o("p",[t._v("图四")]),t._v(" "),o("p",[t._v("而这个标记我们用到了word的一个叫【书签】的功能，打开word按ctrl+shift+F5, 打开书签功能，如下图：")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181029142709314-476661895.png",alt:""}})]),t._v(" "),o("p",[t._v("图五")]),t._v(" "),o("p",[t._v("这样将【规则】通过一系列规则的【书签】定义到word模板中。")]),t._v(" "),o("h2",{attrs:{id:"_3-规则配置"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_3-规则配置"}},[t._v("#")]),t._v(" 3. 规则配置")]),t._v(" "),o("p",[t._v("思路确定了，那就开始设计如何通过【书签】将规则定义到word模板中去，这里决定将所有规则都通过【书签】实现，而放弃config文件的方式，这个更统一而且直观一些。")]),t._v(" "),o("h2",{attrs:{id:"a-循环"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#a-循环"}},[t._v("#")]),t._v(" A.循环")]),t._v(" "),o("p",[t._v("以图四为例，数据库有多少张表是不固定的，我们在制作模板的时候不可能先画好N（N为表的总数）个表格等待数据填充， 这里就会需要遍历数据源中提供的所有表结构数据，然后逐一形成表格。这里就需要将图四中的表格循环一下，自动复制生成多个这样的表格。当然，这只是一种情况，还有可能会出现循环嵌套循环的情况，那么我将这个循环定义成一个书签的时候按照这样的格式：")]),t._v(" "),o("p",[o("strong",[t._v("loop_级别_表序号_filter_名称")])]),t._v(" "),o("p",[t._v("含义如下：")]),t._v(" "),o("p",[t._v("loop：代表这是一个循环。")]),t._v(" "),o("p",[t._v("级别：默认文档级别为0，出现的第一层循环为1，其内部若再次嵌套循环则级别为2，依次类推。")]),t._v(" "),o("p",[t._v("表序号：取Dataset中的第几张表(从1开始)")]),t._v(" "),o("p",[t._v("filter：循环的时候可能会用到对datatable的查找过滤，在此写出，多个字段用XX隔开(因为此处不允许有下划线外其他特殊字符, 就用这个XX吧 )")]),t._v(" "),o("p",[t._v("名称：loop名称，方便与其他 loop区别")]),t._v(" "),o("h2",{attrs:{id:"b-更新指定位置的文字"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#b-更新指定位置的文字"}},[t._v("#")]),t._v(" B.更新指定位置的文字")]),t._v(" "),o("p",[t._v("如图四中的【服务器名】、【表总数】等，只需要替换对应的文字即可：")]),t._v(" "),o("p",[t._v("label_级别_名称")]),t._v(" "),o("p",[t._v("含义如下：")]),t._v(" "),o("p",[t._v("label：代表这是一个label。")]),t._v(" "),o("p",[t._v("级别：默认文档级别为0，出现的第一层循环为1，其内部若再次嵌套循环则级别为2，依次类推。")]),t._v(" "),o("p",[t._v("名称：label名称")]),t._v(" "),o("p",[t._v("注意这里省略了表序号，当级别为0的时候 ，自动取最后一个datatable中的数据，因为这个label经常会用到其他表汇总的数据，可能会用到之前几张表的数据，所以放在其他表都处理好后。当级别为1的时候，自然取该级别循环的行数据。")]),t._v(" "),o("h2",{attrs:{id:"c-表格"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#c-表格"}},[t._v("#")]),t._v(" C.表格")]),t._v(" "),o("p",[t._v("表格的配置原本也想对表格添加书签,后来发现有个表格属性, 觉得写在这里更好一些。")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181029173215552-346156833.png",alt:""}})]),t._v(" "),o("p",[t._v("如上图所示，【标题】格式为："),o("strong",[t._v("table_级别_取Dataset中的第几张表(从1开始)_filter字段多个用XX隔开(此处不允许有下划线外其他特殊字符, 就用这个XX吧 )_名称")])]),t._v(" "),o("p",[t._v("【说明】为可选项，若需要合计行, 则需要标识, summary或缩写s: [合计]行是模板中表格的第几行   summaryfilter或缩写sf:数据集进一步filter到summary行的条件(因为一个表格只取一个Datatable,通过一个标识指定了哪些datarow是用来作为合计的)")]),t._v(" "),o("h2",{attrs:{id:"d-图表"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#d-图表"}},[t._v("#")]),t._v(" D.图表")]),t._v(" "),o("p",[t._v("同样为了方便将配置写在了【标题】，图表生成后会将名称修改过来。")]),t._v(" "),o("p",[t._v("配置格式为:chart_级别_取Dataset中的第几张表(从1开始)_filter字段多个用XX隔开(此处不允许有下划线外其他特殊字符, 就用这个XX吧 )_chart名称_是否将Datatable的columnName作为第一行_从datatable第几列开始(列起始为1)_截止列，")]),t._v(" "),o("p",[t._v("如下图所示配置即可。")]),t._v(" "),o("p",[o("img",{attrs:{src:"/blogimages/WordReport/548134-20181115155921136-2139279347.jpg",alt:""}})]),t._v(" "),o("h2",{attrs:{id:"e-目录"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#e-目录"}},[t._v("#")]),t._v(" E.目录")]),t._v(" "),o("p",[t._v("无需标识, 模板中添加目录, 当内容处理完成之后, 会根据处理后的结果动态更新目录.")]),t._v(" "),o("h2",{attrs:{id:"_4-主要代码"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#_4-主要代码"}},[t._v("#")]),t._v(" 4. 主要代码")]),t._v(" "),o("div",{staticClass:"cnblogs_code",attrs:{onclick:"cnblogs_code_show('9465317b-1eac-42d2-a654-cc47b2fd8c88')"}},[t._v("![](/blogimages/WordReport/ContractedBlock.gif)![](/blogimages/WordReport/ExpandedBlockStart.gif)\n"),o("div",{staticClass:"cnblogs_code_hide",attrs:{id:"cnblogs_code_open_9465317b-1eac-42d2-a654-cc47b2fd8c88"}},[o("p",[o("span",{staticStyle:{color:"#008080"}},[t._v("  1")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  2")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System.Collections.Generic;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  3")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System.Data;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  4")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System.Diagnostics;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  5")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System.IO;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  6")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System.Linq;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  7")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" System.Reflection;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  8")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),t._v(" Excel ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" Microsoft.Office.Interop.Excel;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("  9")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("using")]),t._v(" Word ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" Microsoft.Office.Interop.Word;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 10")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 11")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("namespace")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" FlyLolo.WordReport.Demo\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 12")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("{\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 13")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("class")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" WordReportHelper\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 14")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 15")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" Word.Application wordApp = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 16")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" Word.Document wordDoc = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 17")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" DataSet dataSource = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 18")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("object")]),t._v(" line ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" Word.WdUnits.wdLine;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 19")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" errorMsg = "),o("span",{staticStyle:{color:"#800000"}},[t._v('""')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 20")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 21")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 22")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 根据模板文件,创建数据报告\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 23")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 24")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"templateFile"}})]),o("span",{staticStyle:{color:"#008000"}},[t._v("模板文件名(含路径)")]),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 25")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"newFilePath"}})]),o("span",{staticStyle:{color:"#008000"}},[t._v("新文件路径)")]),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 26")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"dataSource"}})]),o("span",{staticStyle:{color:"#008000"}},[t._v("数据源,包含多个datatable")]),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 27")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"saveFormat"}})]),o("span",{staticStyle:{color:"#008000"}},[t._v("新文件格式:")]),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 28")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),t._v(" CreateReport("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" templateFile, DataSet dataSource, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("out")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" errorMsg, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" newFilePath, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" newFileName, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" saveFormat = "),o("span",{staticStyle:{color:"#800080"}},[t._v("16")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 29")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 30")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".dataSource ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataSource;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 31")]),t._v("             errorMsg = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".errorMsg;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 32")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),t._v(" rtn ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" OpenTemplate(templateFile)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 33")]),t._v("                 && SetContent("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" WordElement(wordDoc.Range(), dataRow: dataSource.Tables[dataSource.Tables.Count - "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("].Rows["),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 34")]),t._v("                 &&"),o("span",{staticStyle:{color:"#000000"}},[t._v(" UpdateTablesOfContents()\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 35")]),t._v("                 && SaveFile(newFilePath, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" newFileName, saveFormat);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 36")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 37")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            CloseAndClear();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 38")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" rtn;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 39")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 40")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 41")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 42")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 打开模板文件\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 43")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 44")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"templateFile"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 45")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 46")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),t._v(" OpenTemplate("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" templateFile)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 47")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 48")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#000000"}},[t._v("File.Exists(templateFile))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 49")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 50")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("false")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 51")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 52")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 53")]),t._v("             wordApp = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" Word.Application();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 54")]),t._v("             wordApp.Visible = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),t._v(";"),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("使文档可见,调试用")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 55")]),t._v("             wordApp.DisplayAlerts ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" Word.WdAlertLevel.wdAlertsNone;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 56")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("object")]),t._v(" file ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" templateFile;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 57")]),t._v("             wordDoc = wordApp.Documents.Open("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),t._v(" file, ReadOnly: "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("false")]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 58")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 59")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 60")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 61")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 62")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 为指定区域写入数据\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 63")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 64")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"element"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 65")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 66")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" SetContent(WordElement element)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 67")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 68")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" currBookMarkName = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".Empty;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 69")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" startWith = "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("loop_")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + (element.Level + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(").ToString() + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[o("em")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 70")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Word.Bookmark item "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" element.Range.Bookmarks)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 71")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 72")]),t._v("                 currBookMarkName ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" item.Name;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 73")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 74")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (currBookMarkName.StartsWith(startWith) && (!"),o("span",{staticStyle:{color:"#000000"}},[t._v("currBookMarkName.Equals(element.ElementName)))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 75")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 76")]),t._v("                     SetLoop("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" WordElement(item.Range, currBookMarkName, element.DataRow, element.GroupBy));\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 77")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 78")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 79")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 80")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 81")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            SetLabel(element);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 82")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 83")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            SetTable(element);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 84")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 85")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            SetChart(element);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 86")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 87")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 88")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 89")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 90")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 91")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 处理循环\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 92")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 93")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"element"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 94")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v(" 95")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" SetLoop(WordElement element)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 96")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 97")]),t._v("             DataRow[] dataRows ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataSource.Tables[element.TableIndex].Select(element.GroupByString);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 98")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" count ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRows.Count();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v(" 99")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            element.Range.Select();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("100")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("101")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("第0行作为模板  先从1开始  循环后处理0行;")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("102")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" i = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("; i < count; i++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("103")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("104")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("105")]),t._v("                 element.Range.Copy();  "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("模板loop复制")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("106")]),t._v("                 wordApp.Selection.InsertParagraphAfter();"),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("换行 不会清除选中的内容,TypeParagraph 等同于回车,若当前有选中内容会被清除. TypeParagraph 会跳到下一行,InsertParagraphAfter不会, 所以movedown一下.")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("107")]),t._v("                 wordApp.Selection.MoveDown("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" line, Missing.Value, Missing.Value);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("108")]),t._v("                 wordApp.Selection.Paste(); "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("换行后粘贴复制内容")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("109")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" offset = wordApp.Selection.Range.End - element.Range.End; "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("计算偏移量\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("110")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("111")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("复制书签,书签名 = 模板书签名 + 复制次数")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("112")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Word.Bookmark subBook "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" element.Range.Bookmarks)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("113")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("114")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" (subBook.Name.Equals(element.ElementName))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("115")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("116")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("continue")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("117")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("118")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("119")]),t._v("                     wordApp.Selection.Bookmarks.Add(subBook.Name + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}}),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + i.ToString(), wordDoc.Range(subBook.Start + offset, subBook.End +"),o("span",{staticStyle:{color:"#000000"}},[t._v(" offset));\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("120")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("121")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("122")]),t._v("                 SetContent("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" WordElement(wordDoc.Range(wordApp.Selection.Range.End - (element.Range.End - element.Range.Start), wordApp.Selection.Range.End), element.ElementName + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[o("em")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" +"),o("span",{staticStyle:{color:"#000000"}},[t._v(" i.ToString(), dataRows[i], element.GroupBy));\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("123")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("124")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("125")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            element.Range.Delete();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("126")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("127")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("128")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("129")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("130")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("131")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 处理简单Label\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("132")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("133")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"element"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("134")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("135")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" SetLabel(WordElement element)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("136")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("137")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (element.Range.Bookmarks != "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(" && element.Range.Bookmarks.Count > "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("138")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("139")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" startWith = "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("label")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + element.Level.ToString() + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[o("em")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("140")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" bookMarkName = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".Empty;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("141")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Word.Bookmark item "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" element.Range.Bookmarks)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("142")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("143")]),t._v("                     bookMarkName ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" item.Name;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("144")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("145")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" (bookMarkName.StartsWith(startWith))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("146")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("147")]),t._v("                         bookMarkName ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" WordElement.GetName(bookMarkName);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("148")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("149")]),t._v("                         item.Range.Text ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" element.DataRow[bookMarkName].ToString();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("150")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("151")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("152")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("153")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("154")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("155")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("156")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("157")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("158")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 填充Table\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("159")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("160")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"element"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("161")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("162")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" SetTable(WordElement element)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("163")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("164")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (element.Range.Tables != "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(" && element.Range.Tables.Count > "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("165")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("166")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" startWith = "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("table")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + element.Level.ToString() + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[o("em")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("167")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Word.Table table "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" element.Range.Tables)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("168")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("169")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(table.Title) &&"),o("span",{staticStyle:{color:"#000000"}},[t._v(" table.Title.StartsWith(startWith))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("170")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("171")]),t._v("                         WordElement tableElement = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" WordElement("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(", table.Title, element.DataRow);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("172")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("173")]),t._v("                         TableConfig config = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" TableConfig(table.Descr);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("174")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("175")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("object")]),t._v(" dataRowTemplate ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" table.Rows[config.DataRow];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("176")]),t._v("                         Word.Row SummaryRow = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("177")]),t._v("                         DataRow SummaryDataRow = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("178")]),t._v("                         DataTable dt ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataSource.Tables[tableElement.TableIndex];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("179")]),t._v("                         DataRow[] dataRows ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataSource.Tables[tableElement.TableIndex].Select(tableElement.GroupByString); ;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("180")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("181")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (config.SummaryRow > "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("182")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("183")]),t._v("                             SummaryRow ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" table.Rows[config.SummaryRow];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("184")]),t._v("                             SummaryDataRow = dt.Select("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(tableElement.GroupByString) ? config.SummaryFilter : tableElement.GroupByString + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v(" and  ")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" +"),o("span",{staticStyle:{color:"#000000"}},[t._v(" config.SummaryFilter).FirstOrDefault();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("185")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("186")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("187")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (DataRow row "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRows)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("188")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("189")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (row =="),o("span",{staticStyle:{color:"#000000"}},[t._v(" SummaryDataRow)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("190")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("191")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("continue")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("192")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("193")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("194")]),t._v("                             Word.Row newRow = table.Rows.Add("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRowTemplate);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("195")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" j = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("; j < table.Columns.Count; j++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("196")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("197")]),t._v("                                 newRow.Cells[j + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("].Range.Text ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" row[j].ToString(); ;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("198")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("199")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("200")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("201")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("202")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        ((Word.Row)dataRowTemplate).Delete();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("203")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("204")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (config.SummaryRow > "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v(" && SummaryDataRow != "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("205")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("206")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" j = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("; j < SummaryRow.Cells.Count; j++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("207")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("208")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" temp = SummaryRow.Cells[j + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("].Range.Text.Trim().Replace("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("\\r\\a")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(", "),o("span",{staticStyle:{color:"#800000"}},[t._v('""')]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("209")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("210")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(temp) && temp.Length > "),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),t._v(" && dt.Columns.Contains(temp.Substring("),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(", temp.Length - "),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("211")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("212")]),t._v("                                     SummaryRow.Cells[j + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("].Range.Text = SummaryDataRow[temp.Substring("),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(", temp.Length - "),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")].ToString();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("213")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("214")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("215")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("216")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("217")]),t._v("                         table.Title ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" tableElement.Name;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("218")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("219")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("220")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("221")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("222")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("223")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("224")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("225")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("226")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("227")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("228")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 处理图表\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("229")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("230")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"element"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("231")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("232")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" SetChart(WordElement element)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("233")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("234")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (element.Range.InlineShapes != "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(" && element.Range.InlineShapes.Count > "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("235")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("236")]),t._v("                 List<Word.InlineShape> chartList = element.Range.InlineShapes.Cast<Word.InlineShape>().Where(m => m.Type =="),o("span",{staticStyle:{color:"#000000"}},[t._v(" Word.WdInlineShapeType.wdInlineShapeChart).ToList();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("237")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" startWith = "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("chart")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + element.Level.ToString() + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[o("em")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("238")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Word.InlineShape item "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" chartList)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("239")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("240")]),t._v("                     Word.Chart chart ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" item.Chart;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("241")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(chart.ChartTitle.Text) &&"),o("span",{staticStyle:{color:"#000000"}},[t._v(" chart.ChartTitle.Text.StartsWith(startWith))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("242")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("243")]),t._v("                         WordElement chartElement = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" WordElement("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(", chart.ChartTitle.Text, element.DataRow);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("244")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("245")]),t._v("                         DataTable dataTable ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataSource.Tables[chartElement.TableIndex];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("246")]),t._v("                         DataRow[] dataRows ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataTable.Select(chartElement.GroupByString);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("247")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("248")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" columnCount ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataTable.Columns.Count;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("249")]),t._v("                         List<"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v("> columns = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" List<"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(">"),o("span",{staticStyle:{color:"#000000"}},[t._v("();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("250")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("251")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("var")]),t._v(" dr "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRows)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("252")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("253")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" i = chartElement.ColumnStart == -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(" ? "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v(" : chartElement.ColumnStart - "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("; i < (chartElement.ColumnEnd == -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(" ? columnCount : chartElement.ColumnEnd); i++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("254")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("255")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (columns.Contains(i) || dr[i] == "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(" || "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".IsNullOrEmpty(dr[i].ToString()))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("256")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("257")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("258")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("259")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("else")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("260")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("261")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                    columns.Add(i);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("262")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("263")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("264")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("265")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        columns.Sort();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("266")]),t._v("                         columnCount ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" columns.Count;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("267")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" rowsCount ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRows.Length;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("268")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("269")]),t._v("                         Word.ChartData chartData ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" chart.ChartData;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("270")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("271")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("chartData.Activate();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("272")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("此处有个比较疑惑的问题, 不执行此条,生成的报告中的图表无法再次右键编辑数据. 执行后可以, 但有两个问题就是第一会弹出Excel框, 处理完后会自动关闭. 第二部分chart的数据range设置总不对\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("273")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("不知道是不是版本的问题, 谁解决了分享一下,谢谢")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("274")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("275")]),t._v("                         Excel.Workbook dataWorkbook ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" (Excel.Workbook)chartData.Workbook;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("276")]),t._v("                         dataWorkbook.Application.Visible = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("false")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("277")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("278")]),t._v("                         Excel.Worksheet dataSheet = (Excel.Worksheet)dataWorkbook.Worksheets["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("279")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("设定范围  ")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("280")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" a = (chartElement.ColumnNameForHead ? rowsCount + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(" : rowsCount) + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("|")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" +"),o("span",{staticStyle:{color:"#000000"}},[t._v(" columnCount;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("281")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        Console.WriteLine(a);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("282")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("283")]),t._v("                         Excel.Range tRange = dataSheet.Range["),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("A1")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(", dataSheet.Cells[(chartElement.ColumnNameForHead ? rowsCount + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" : rowsCount), columnCount]];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("284")]),t._v("                         Excel.ListObject tbl1 = dataSheet.ListObjects["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("285")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("dataSheet.ListObjects[1].Delete(); ")]),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("想过重新删除再添加  这样 原有数据清掉了, 但觉得性能应该会有所下降\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("286")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("Excel.ListObject tbl1 = dataSheet.ListObjects.AddEx();")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("287")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        tbl1.Resize(tRange);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("288")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" j = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("; j < rowsCount; j++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("289")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("290")]),t._v("                             DataRow row ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRows[j];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("291")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" k = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("; k < columnCount; k++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("292")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("293")]),t._v("                                 dataSheet.Cells[j + "),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),t._v(", k + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("].FormulaR1C1 ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" row[columns[k]];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("294")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("295")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("296")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("297")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" (chartElement.ColumnNameForHead)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("298")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("299")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("for")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" k = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("; k < columns.Count; k++"),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("300")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("301")]),t._v("                                 dataSheet.Cells["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(", k + "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v("].FormulaR1C1 ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataTable.Columns[columns[k]].ColumnName;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("302")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("303")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("304")]),t._v("                         chart.ChartTitle.Text ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" chartElement.Name;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("305")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("dataSheet.Application.Quit();")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("306")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("307")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("308")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("309")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("310")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("311")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("312")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("313")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("314")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 更新目录\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("315")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("316")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("317")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" UpdateTablesOfContents()\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("318")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("319")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Word.TableOfContents item "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" wordDoc.TablesOfContents)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("320")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("321")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                item.Update();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("322")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("323")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("324")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("325")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("326")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("327")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("328")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 保存文件\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("329")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("330")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"newFilePath"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("331")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"newFileName"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("332")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"saveFormat"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("333")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("returns")],1),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("334")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),t._v(" SaveFile("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" newFilePath, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" newFileName, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" saveFormat = "),o("span",{staticStyle:{color:"#800080"}},[t._v("16")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("335")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("336")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".IsNullOrEmpty(newFileName))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("337")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("338")]),t._v("                 newFileName = DateTime.Now.ToString("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("yyyyMMddHHmmss")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("339")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("340")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("switch")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" (saveFormat)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("341")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("342")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v(":"),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" Word.WdSaveFormat.wdFormatDocument")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("343")]),t._v("                         newFileName += "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v(".doc")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("344")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("345")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800080"}},[t._v("16")]),t._v(":"),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" Word.WdSaveFormat.wdFormatDocumentDefault")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("346")]),t._v("                         newFileName += "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v(".docx")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("347")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("348")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800080"}},[t._v("17")]),t._v(":"),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" Word.WdSaveFormat.wdFormatPDF")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("349")]),t._v("                         newFileName += "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v(".pdf")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("350")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("351")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("default")]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("352")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("353")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("354")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("355")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("356")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("object")]),t._v(" newfile ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" Path.Combine(newFilePath, newFileName);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("357")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("object")]),t._v(" wdSaveFormat ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" saveFormat;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("358")]),t._v("             wordDoc.SaveAs("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),t._v(" newfile, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("ref")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" wdSaveFormat);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("359")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("true")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("360")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("361")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("362")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("363")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 清理\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("364")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("365")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("void")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" CloseAndClear()\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("366")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("367")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (wordApp == "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("368")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("369")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("370")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("371")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            wordDoc.Close(Word.WdSaveOptions.wdDoNotSaveChanges);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("372")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            wordApp.Quit(Word.WdSaveOptions.wdDoNotSaveChanges);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("373")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            System.Runtime.InteropServices.Marshal.ReleaseComObject(wordDoc);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("374")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            System.Runtime.InteropServices.Marshal.ReleaseComObject(wordApp);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("375")]),t._v("             wordDoc = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("376")]),t._v("             wordApp = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("377")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            GC.Collect();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("378")]),t._v("             KillProcess("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("Excel")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(", "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("WINWORD")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("379")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("380")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("381")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("382")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 杀进程..\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("383")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("384")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("param",{attrs:{name:"processNames"}})]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("385")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("private")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("void")]),t._v(" KillProcess("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("params")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v("[] processNames)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("386")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("387")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("Process myproc = new Process();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("388")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("得到所有打开的进程  ")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("389")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("try")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("390")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("391")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" name "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" processNames)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("392")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("393")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" (Process thisproc "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" Process.GetProcessesByName(name))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("394")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("395")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#000000"}},[t._v("thisproc.CloseMainWindow())\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("396")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("397")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (thisproc != "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("398")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                                thisproc.Kill();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("399")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("400")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("401")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("402")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("403")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("catch")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" (Exception)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("404")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("405")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v("throw Exc;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("406")]),t._v(" "),o("span",{staticStyle:{color:"#008000"}},[t._v("//")]),o("span",{staticStyle:{color:"#008000"}},[t._v(' msg.Text+=  "杀死"  +  processName  +  "失败！";  ')]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("407")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("408")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("409")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("410")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("411")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("412")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" 封装的Word元素\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("413")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("414")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("class")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" WordElement\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("415")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("416")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" WordElement(Word.Range range, "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" elementName = "),o("span",{staticStyle:{color:"#800000"}},[t._v('""')]),t._v(", DataRow dataRow = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(", Dictionary<"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(", "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("> groupBy = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(", "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" tableIndex = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("417")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("418")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".Range ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" range;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("419")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ElementName ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" elementName;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("420")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".GroupBy ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" groupBy;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("421")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".DataRow ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" dataRow;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("422")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".IsNullOrEmpty(elementName))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("423")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("424")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".Level = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("425")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".TableIndex ="),o("span",{staticStyle:{color:"#000000"}},[t._v(" tableIndex;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("426")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".Name = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".Empty;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("427")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnNameForHead = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("false")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("428")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("429")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("else")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("430")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("431")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("[] element = elementName.Split("),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#800000"}}),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("432")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".Level = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(".Parse(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("433")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnNameForHead = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("false")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("434")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnStart = -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("435")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnEnd = -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("436")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("437")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (element["),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("].Equals("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("label")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v("))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("438")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("439")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".Name = element["),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("440")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".TableIndex = "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("441")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("442")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("else")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("443")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("444")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".Name = element["),o("span",{staticStyle:{color:"#800080"}},[t._v("4")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("445")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".TableIndex = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(".Parse(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),t._v("]) - "),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("446")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("447")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("3")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("448")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("449")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("[] filters = element["),o("span",{staticStyle:{color:"#800080"}},[t._v("3")]),t._v("].Split("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("[] { "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("XX")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(" }, StringSplitOptions.RemoveEmptyEntries);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("450")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".GroupBy == "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("451")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("452")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".GroupBy = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("new")]),t._v(" Dictionary<"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(", "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(">"),o("span",{staticStyle:{color:"#000000"}},[t._v("();\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("453")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("454")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" item "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" filters)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("455")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("456")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".GroupBy.Keys.Contains(item))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("457")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("458")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".GroupBy.Add(item, dataRow[item].ToString());\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("459")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("460")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("461")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("462")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("463")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("464")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (element["),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("].Equals("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("chart")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(") && element.Count() > "),o("span",{staticStyle:{color:"#800080"}},[t._v("5")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("465")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("466")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnNameForHead = element["),o("span",{staticStyle:{color:"#800080"}},[t._v("5")]),t._v("].Equals("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("1")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("467")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnStart = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("6")]),t._v("]) ? -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(" : "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(".Parse(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("6")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("468")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".ColumnEnd = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(".IsNullOrEmpty(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("7")]),t._v("]) ? -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),t._v(" : "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(".Parse(element["),o("span",{staticStyle:{color:"#800080"}},[t._v("7")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("469")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("470")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("471")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("472")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("473")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("474")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" Word.Range Range { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("475")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" Level { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("476")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" TableIndex { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("477")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" ElementName { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("478")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("479")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" DataRow DataRow { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("480")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" Dictionary<"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(", "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("> GroupBy { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("481")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("482")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" Name { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("483")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("484")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("bool")]),t._v(" ColumnNameForHead { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("485")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" ColumnStart { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("486")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" ColumnEnd { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("487")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("488")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" GroupByString\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("489")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("490")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("491")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("492")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (GroupBy == "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("null")]),t._v(" || GroupBy.Count == "),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("493")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("494")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".Empty;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("495")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("496")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("497")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" rtn = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".Empty;\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("498")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" key "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".GroupBy.Keys)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("499")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("500")]),t._v("                     rtn += "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("and ")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + key + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v(" = '")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),t._v(" + GroupBy[key] + "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("' ")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("501")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("502")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" rtn.Substring("),o("span",{staticStyle:{color:"#800080"}},[t._v("3")]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("503")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("504")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("505")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("506")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("static")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" GetName("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" elementName)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("507")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("508")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("[] element = elementName.Split("),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#800000"}},[t._v("_")]),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("509")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("510")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("511")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (element["),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),t._v("].Equals("),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("label")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v("))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("512")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("513")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" element["),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("514")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("515")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("else")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("516")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("517")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("return")]),t._v(" element["),o("span",{staticStyle:{color:"#800080"}},[t._v("4")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("518")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("519")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("520")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("521")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("522")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[o("summary")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("523")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),o("span",{staticStyle:{color:"#008000"}},[t._v(" Table配置项\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("524")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}},[t._v("///")]),t._v(" "),o("span",{staticStyle:{color:"#808080"}}),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("525")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("class")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" TableConfig\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("526")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("527")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" TableConfig("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" tableDescr = "),o("span",{staticStyle:{color:"#800000"}},[t._v('""')]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("528")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("529")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".DataRow = "),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("530")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".SummaryRow = -"),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("531")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("532")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".IsNullOrEmpty(tableDescr))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("533")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("534")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("[] element = tableDescr.Split("),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#800000"}},[t._v(",")]),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("535")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("foreach")]),t._v(" ("),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" item "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("in")]),o("span",{staticStyle:{color:"#000000"}},[t._v(" element)\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("536")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("537")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (!"),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),o("span",{staticStyle:{color:"#000000"}},[t._v(".IsNullOrEmpty(item))\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("538")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("539")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v("[] configs = item.Split("),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#800000"}},[t._v(":")]),o("span",{staticStyle:{color:"#800000"}},[t._v("'")]),o("span",{staticStyle:{color:"#000000"}},[t._v(");\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("540")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("if")]),t._v(" (configs.Length == "),o("span",{staticStyle:{color:"#800080"}},[t._v("2")]),o("span",{staticStyle:{color:"#000000"}},[t._v(")\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("541")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("542")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("switch")]),t._v(" (configs["),o("span",{staticStyle:{color:"#800080"}},[t._v("0")]),o("span",{staticStyle:{color:"#000000"}},[t._v("].ToLower())\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("543")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            {\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("544")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("data")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("545")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("d")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("546")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".DataRow = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(".Parse(configs["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("547")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("548")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("summary")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("549")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("s")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("550")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".SummaryRow = "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(".Parse(configs["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v("]);\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("551")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("552")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("summaryfilter")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("553")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("case")]),t._v(" "),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#800000"}},[t._v("sf")]),o("span",{staticStyle:{color:"#800000"}},[t._v('"')]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("554")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("this")]),t._v(".SummaryFilter = configs["),o("span",{staticStyle:{color:"#800080"}},[t._v("1")]),o("span",{staticStyle:{color:"#000000"}},[t._v("];\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("555")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("556")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("default")]),o("span",{staticStyle:{color:"#000000"}},[t._v(":\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("557")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("break")]),o("span",{staticStyle:{color:"#000000"}},[t._v(";\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("558")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("559")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("560")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("561")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("                }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("562")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("            }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("563")]),t._v(" "),o("span",{staticStyle:{color:"#008080"}},[t._v("564")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("        }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("565")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" DataRow { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("566")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("int")]),t._v(" SummaryRow { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("567")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("public")]),t._v(" "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("string")]),t._v(" SummaryFilter { "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("get")]),t._v("; "),o("span",{staticStyle:{color:"#0000ff"}},[t._v("set")]),o("span",{staticStyle:{color:"#000000"}},[t._v("; }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("568")]),t._v(" "),o("span",{staticStyle:{color:"#000000"}},[t._v("    }\n")]),o("span",{staticStyle:{color:"#008080"}},[t._v("569")]),t._v(" }")])]),t._v(" "),o("span",{staticClass:"cnblogs_code_collapse"},[t._v("View Code")])])])}),[],!1,null,null,null);a.default=s.exports}}]);